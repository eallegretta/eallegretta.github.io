window.paletools = window.paletools || {};
window.paletools['palesnipe-2.1.0'] = "KGZ1bmN0aW9uIChidXR0b25zKSB7DQogICAgY29uc3QgVkVSU0lPTiA9ICJ2Mi4xLjAiOw0KDQogICAgYnV0dG9ucyA9ICQuZXh0ZW5kKHsNCiAgICAgICAgYmFjazogJ0RpZ2l0MScsDQogICAgICAgIGVuYWJsZURpc2FibGU6ICdDb21tYScsDQogICAgICAgIGxpc3RzOiB7DQogICAgICAgICAgICB1cDogJ0Fycm93VXAnLA0KICAgICAgICAgICAgZG93bjogJ0Fycm93RG93bicsDQogICAgICAgICAgICBwcmV2OiAnQXJyb3dMZWZ0JywNCiAgICAgICAgICAgIG5leHQ6ICdBcnJvd1JpZ2h0JywNCiAgICAgICAgfSwNCiAgICAgICAgc2VhcmNoOiB7DQogICAgICAgICAgICByZXNldEJpZDogJ0JhY2txdW90ZScsDQogICAgICAgICAgICBkZWNNaW5CaWQ6ICdBcnJvd0xlZnQnLA0KICAgICAgICAgICAgaW5jTWluQmlkOiAnQXJyb3dSaWdodCcsDQogICAgICAgICAgICBkZWNNYXhCaWQ6ICdFbmQnLA0KICAgICAgICAgICAgaW5jTWF4QmlkOiAnSG9tZScsDQogICAgICAgICAgICBkZWNNaW5CdXk6ICdEZWxldGUnLA0KICAgICAgICAgICAgaW5jTWluQnV5OiAnUGFnZURvd24nLA0KICAgICAgICAgICAgZGVjTWF4QnV5OiAnQXJyb3dEb3duJywNCiAgICAgICAgICAgIGluY01heEJ1eTogJ0Fycm93VXAnLA0KICAgICAgICAgICAgc2VhcmNoOiAnRGlnaXQyJywNCiAgICAgICAgICAgIGJvdE1vZGVNaW5CaWQ6ICdDb250cm9sUmlnaHQnLA0KICAgICAgICAgICAgYm90TW9kZU1pbkJ1eTogJ0NvbnRyb2xMZWZ0Jw0KICAgICAgICB9LA0KICAgICAgICByZXN1bHRzOiB7DQogICAgICAgICAgICBiaWQ6ICdEaWdpdDQnLA0KICAgICAgICAgICAgYnV5OiAnRGlnaXQzJywNCiAgICAgICAgICAgIHRyYW5zZmVyOiAnS2V5UicsDQogICAgICAgICAgICBjbHViOiAnS2V5QycsDQogICAgICAgICAgICBwcmVzc0VudGVyOiB0cnVlLA0KICAgICAgICAgICAgYXV0b0J1eTogZmFsc2UsDQogICAgICAgICAgICBwcmV2ZW50QmFjazogZmFsc2UsDQogICAgICAgICAgICBzZWxsOiAnS2V5UScsDQogICAgICAgICAgICBkZWNCaWQ6ICdEZWxldGUnLA0KICAgICAgICAgICAgaW5jQmlkOiAnUGFnZURvd24nDQogICAgICAgIH0NCiAgICB9LCBidXR0b25zIHx8IHt9KTsNCiAgICBsZXQgcCA9IGJ1dHRvbnM7DQogICAgbGV0IGVuYWJsZWQgPSB0cnVlOw0KICAgIGxldCBiYWNrQnV0dG9uTGFzdERhdGUgPSBuZXcgRGF0ZSgpOw0KICAgIGxldCBiYWNrQnV0dG9uUHJlc3NlZE9uUmVzdWx0ID0gZmFsc2U7DQoNCiAgICAvLyByZXNldCBjb25zb2xlDQogICAgdmFyIGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpOw0KICAgIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lKTsNCiAgICB3aW5kb3cuY29uc29sZSA9IGlmcmFtZS5jb250ZW50V2luZG93LmNvbnNvbGU7DQoNCiAgICB3aW5kb3cuTUFYX05FV19JVEVNUyA9IE51bWJlci5NQVhfVkFMVUU7DQoNCiAgICBVVEl0ZW1Eb21haW5SZXBvc2l0b3J5LnByb3RvdHlwZS5pc1BpbGVGdWxsID0gZnVuY3Rpb24oZSkgew0KICAgICAgICB2YXIgdCA9IDANCiAgICAgICAgICAsIGkgPSB0aGlzLnBpbGVTaXplcy5nZXQoZSk7DQogICAgICAgIHN3aXRjaCAoZSkgew0KICAgICAgICBjYXNlIEl0ZW1QaWxlLlBVUkNIQVNFRDoNCiAgICAgICAgICAgIHQgPSB0aGlzLnVuYXNzaWduZWQubGVuZ3RoOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgSXRlbVBpbGUuVFJBTlNGRVI6DQogICAgICAgICAgICB0ID0gdGhpcy50cmFuc2Zlci5sZW5ndGg7DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSBJdGVtUGlsZS5JTkJPWDoNCiAgICAgICAgICAgIHJldHVybiAwOw0KICAgICAgICBjYXNlIEl0ZW1QaWxlLkNMVUI6DQogICAgICAgICAgICByZXR1cm4gITENCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gKGkgfHwgMCkgPD0gdA0KICAgIH0NCg0KICAgIGNvbnN0DQogICAgICAgIGwgPSBjb25zb2xlLmxvZywNCiAgICAgICAgbG9jID0gd2luZG93LnNlcnZpY2VzLkxvY2FsaXphdGlvbiwNCiAgICAgICAgQkFDS19CVVRUT05fVEhSRVNIT0xEID0gNTAwLA0KICAgICAgICBkaXNwYXRjaE1vdXNlRXZlbnQgPSAoJHRhcmdldCwgZXZlbnROYW1lKSA9PiB7DQogICAgICAgICAgICBpZiAoJHRhcmdldC5sZW5ndGggPT0gMCkgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgY29uc3QgbW91c2VFdmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdNb3VzZUV2ZW50cycpOw0KICAgICAgICAgICAgbW91c2VFdmVudC5pbml0RXZlbnQoZXZlbnROYW1lKTsNCiAgICAgICAgICAgICR0YXJnZXRbMF0uZGlzcGF0Y2hFdmVudChtb3VzZUV2ZW50KTsNCiAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICB9LA0KICAgICAgICBtb3VzZURvd24gPSB0YXJnZXQgPT4gZGlzcGF0Y2hNb3VzZUV2ZW50KHRhcmdldCwgJ21vdXNlZG93bicpLA0KICAgICAgICBtb3VzZVVwID0gdGFyZ2V0ID0+IGRpc3BhdGNoTW91c2VFdmVudCh0YXJnZXQsICdtb3VzZXVwJyksDQogICAgICAgIG1vdXNlQ2xpY2sgPSAodGFyZ2V0LCBkZWxheSwgY2FsbGJhY2spID0+IHsNCiAgICAgICAgICAgIGlmIChkZWxheSkgew0KICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICBjYWxsYmFjayhtb3VzZUNsaWNrKHRhcmdldCkpOw0KICAgICAgICAgICAgICAgIH0sIGRlbGF5KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgIHJldHVybiBtb3VzZURvd24odGFyZ2V0KSAmJiBtb3VzZVVwKHRhcmdldCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGJ1eU5vdyA9IChjYWxsYmFjaykgPT4gew0KICAgICAgICAgICAgaWYgKG1vdXNlQ2xpY2soYnV5QnRuKCkpKSB7DQogICAgICAgICAgICAgICAgaWYgKHAucmVzdWx0cy5wcmVzc0VudGVyKSB7DQogICAgICAgICAgICAgICAgICAgIHRyeVByZXNzT2tCdG4oY2FsbGJhY2spOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgdHJ5UHJlc3NPa0J0biA9IChjYWxsYmFjaykgPT4gew0KICAgICAgICAgICAgaWYgKCFtb3VzZUNsaWNrKGVudGVyQnRuKCkpKSB7DQogICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7DQogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoY2FsbGJhY2soZmFsc2UpLCAwKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHRyeVByZXNzT2tCdG4sIDEwKTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2spIHsNCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sodHJ1ZSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHVwZGF0ZUJvdWdodFVJKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIGJhY2sgPSAoKSA9PiB7DQogICAgICAgICAgICBsKCdiYWNrJyk7DQogICAgICAgICAgICAvLyBmb3JjZSBkb3VibGUgYmFjayB3aGVuIHRoZXJlIGlzIGEgY2FyZCBvbiB0aGUgbGlzdA0KICAgICAgICAgICAgLy8gaWYgKG5ldyBEYXRlKCkgLSBiYWNrQnV0dG9uTGFzdERhdGUgPCBCQUNLX0JVVFRPTl9USFJFU0hPTEQpIHsNCiAgICAgICAgICAgIC8vICAgICByZXR1cm47DQogICAgICAgICAgICAvLyB9DQogICAgICAgICAgICAvLyBiYWNrQnV0dG9uTGFzdERhdGUgPSBuZXcgRGF0ZSgpOw0KICAgICAgICAgICAgaWYgKCFtb3VzZUNsaWNrKGJhY2tCdG4oKSkpIHsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGJhY2ssIDEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHNlYXJjaCA9ICgpID0+IHsNCiAgICAgICAgICAgIG1vdXNlQ2xpY2soc2VhcmNoQnRuKCkpOw0KICAgICAgICAgICAgaWYgKHAucmVzdWx0cy5hdXRvQnV5KSB7DQogICAgICAgICAgICAgICAgaWYgKHNlYXJjaFJlc3VsdHMoKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIGwoJ3Jlc2VhcmNoaW5nJyk7DQogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoc2VhcmNoLCAxMCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBsKCQoIi51dC1uby1yZXN1bHRzLXZpZXciKS5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoJCgiLnV0LW5vLXJlc3VsdHMtdmlldyIpLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGwoJ25vIHJlc3VsdHMnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2soKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGwoJ2J1eWluZycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnV5Tm93KChib3VnaHQpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm91Z2h0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vdXNlQ2xpY2sodHJhbnNmZXJCdG4oKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgdHJhbnNmZXJCdG4gPSAoKSA9PiAkKGAudXQtYnV0dG9uLWdyb3VwID4gYnV0dG9uOmNvbnRhaW5zKCcke2xvYy5sb2NhbGl6ZSgnaW5mb3BhbmVsLmxhYmVsLnNlbmRUcmFkZVBpbGUnKX0nKWApLA0KICAgICAgICBjbHViQnRuID0gKCkgPT4gJChgLnV0LWJ1dHRvbi1ncm91cCA+IGJ1dHRvbjpjb250YWlucygnJHtsb2MubG9jYWxpemUoJ2luZm9wYW5lbC5sYWJlbC5zdG9yZUluQ2x1YicpfScpYCksDQogICAgICAgIHNlbGxCdG4gPSAoKSA9PiAkKGAudXQtYnV0dG9uLWdyb3VwID4gYnV0dG9uOmNvbnRhaW5zKCcke2xvYy5sb2NhbGl6ZSgnaW5mb3BhbmVsLmxhYmVsLmRpc2NhcmQnKX0nKWApLA0KICAgICAgICBidXlCdG4gPSAoKSA9PiAkKCcuYnV5QnV0dG9uJyksDQogICAgICAgIGJhY2tCdG4gPSAoKSA9PiAkKCcudXQtbmF2aWdhdGlvbi1idXR0b24tY29udHJvbCcpLA0KICAgICAgICBlbnRlckJ0biA9ICgpID0+ICQoJy5lYS1kaWFsb2ctdmlldyAudXQtYnV0dG9uLWdyb3VwIGJ1dHRvbjplcSgwKScpLA0KICAgICAgICBzZWFyY2hCdG4gPSAoKSA9PiAkKCcuYnV0dG9uLWNvbnRhaW5lciAuYnRuLXN0YW5kYXJkLmNhbGwtdG8tYWN0aW9uJyksDQogICAgICAgIHNlYXJjaFJlc3VsdHMgPSAoKSA9PiAkKCcuU2VhcmNoUmVzdWx0cycpLmxlbmd0aCwNCg0KDQogICAgICAgIGtleXMgPSAoKSA9PiB7DQogICAgICAgICAgICBsZXQgYiA9IHt9Ow0KDQogICAgICAgICAgICBiW3AuYmFja10gPSAoKSA9PiBiYWNrKCk7DQoNCiAgICAgICAgICAgIGlmICgkKCcudXQtbWFya2V0LXNlYXJjaC1maWx0ZXJzLXZpZXcnKS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5kZWNNaW5CaWRdID0gKCkgPT4gbW91c2VDbGljaygkKCcuZGVjcmVtZW50LXZhbHVlJykpOw0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guaW5jTWluQmlkXSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmluY3JlbWVudC12YWx1ZScpKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmRlY01heEJpZF0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5kZWNyZW1lbnQtdmFsdWU6ZXEoMSknKSk7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5pbmNNYXhCaWRdID0gKCkgPT4gbW91c2VDbGljaygkKCcuaW5jcmVtZW50LXZhbHVlOmVxKDEpJykpOw0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guZGVjTWluQnV5XSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmRlY3JlbWVudC12YWx1ZTplcSgyKScpKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmluY01pbkJ1eV0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5pbmNyZW1lbnQtdmFsdWU6ZXEoMiknKSk7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5kZWNNYXhCdXldID0gKCkgPT4gbW91c2VDbGljaygkKCcuZGVjcmVtZW50LXZhbHVlOmVxKDMpJykpOw0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guaW5jTWF4QnV5XSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmluY3JlbWVudC12YWx1ZTplcSgzKScpKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLnNlYXJjaF0gPSAoKSA9PiBzZWFyY2goKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLnJlc2V0QmlkXSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLnNlYXJjaC1wcmljZS1oZWFkZXIgPiBidXR0b246Zmlyc3QnKSk7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5ib3RNb2RlTWluQmlkXSA9ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYoYltwLnNlYXJjaC5pbmNNaW5CaWRdKCkpew0KICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guYm90TW9kZU1pbkJ1eV0gPSAoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGlmKGJbcC5zZWFyY2guaW5jTWluQnV5XSgpKXsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgbGV0IGl0ZW1zID0gJCgiLmxpc3RGVVRJdGVtIik7DQogICAgICAgICAgICAgICAgbGV0IGl0ZW1zRXhpc3RzID0gaXRlbXMubGVuZ3RoID4gMDsNCiAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250YWluZXIgPSBpdGVtcy5wYXJlbnRzKCcucGFnaW5hdGVkLCAudXQtd2F0Y2gtbGlzdC12aWV3LCAudXQtdHJhbnNmZXItbGlzdC12aWV3Jyk7DQogICAgICAgICAgICAgICAgaWYgKGl0ZW1zQ29udGFpbmVyLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIGl0ZW1zQ29udGFpbmVyID0gaXRlbXMucGFyZW50KCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChpdGVtc0V4aXN0cyAmJiAkKCcuRGV0YWlsUGFuZWwgPiAuYmlkT3B0aW9ucycpLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgYltwLnJlc3VsdHMuYmlkXSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmJpZEJ1dHRvbicpKTsNCiAgICAgICAgICAgICAgICAgICAgYltwLnJlc3VsdHMuYnV5XSA9ICgpID0+IGJ1eU5vdygpOw0KICAgICAgICAgICAgICAgICAgICBiW3AucmVzdWx0cy5kZWNCaWRdID0gKCkgPT4gbW91c2VDbGljaygkKCcuYmlkT3B0aW9ucyAuZGVjcmVtZW50LXZhbHVlJykpOw0KICAgICAgICAgICAgICAgICAgICBiW3AucmVzdWx0cy5pbmNCaWRdID0gKCkgPT4gbW91c2VDbGljaygkKCcuYmlkT3B0aW9ucyAuaW5jcmVtZW50LXZhbHVlJykpOw0KICAgICAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmJvdE1vZGVNaW5CaWRdID0gKCkgPT4gYnV5Tm93KCk7DQogICAgICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guYm90TW9kZU1pbkJ1eV0gPSAoKSA9PiBidXlOb3coKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoaXRlbXNFeGlzdHMgJiYgJCgnLkRldGFpbFBhbmVsID4gLnV0LWJ1dHRvbi1ncm91cCcpLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgYltwLnJlc3VsdHMudHJhbnNmZXJdID0gKCkgPT4gbW91c2VDbGljayh0cmFuc2ZlckJ0bigpKTsNCiAgICAgICAgICAgICAgICAgICAgYltwLnJlc3VsdHMuY2x1Yl0gPSAoKSA9PiBtb3VzZUNsaWNrKGNsdWJCdG4oKSk7DQogICAgICAgICAgICAgICAgICAgIGJbcC5yZXN1bHRzLnNlbGxdID0gKCkgPT4gbW91c2VDbGljayhzZWxsQnRuKCkpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmIChpdGVtc0V4aXN0cykgew0KICAgICAgICAgICAgICAgICAgICBiW3AubGlzdHMudXBdID0gKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IGl0ZW1zQ29udGFpbmVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkID0gJCgnLmxpc3RGVVRJdGVtLnNlbGVjdGVkJywgY29udGFpbmVyKS5wcmV2KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWQubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSAkKCIubGlzdEZVVEl0ZW06bGFzdC1jaGlsZCIsIGNvbnRhaW5lcik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBtb3VzZUNsaWNrKHNlbGVjdGVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jc3MoJ3Bvc2l0aW9uJywgJ3JlbGF0aXZlJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuc2Nyb2xsVG9wKGNvbnRhaW5lci5zY3JvbGxUb3AoKSArIHNlbGVjdGVkLnBvc2l0aW9uKCkudG9wIC0gc2VsZWN0ZWQuaGVpZ2h0KCkpOw0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgICAgICBiW3AubGlzdHMuZG93bl0gPSAoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0gaXRlbXNDb250YWluZXI7DQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWQgPSAkKCcubGlzdEZVVEl0ZW0uc2VsZWN0ZWQnLCBjb250YWluZXIpLm5leHQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZC5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9ICQoIi5saXN0RlVUSXRlbTpmaXJzdC1jaGlsZCIsIGNvbnRhaW5lcik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBtb3VzZUNsaWNrKHNlbGVjdGVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5jc3MoJ3Bvc2l0aW9uJywgJ3JlbGF0aXZlJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuc2Nyb2xsVG9wKGNvbnRhaW5lci5zY3JvbGxUb3AoKSArIHNlbGVjdGVkLnBvc2l0aW9uKCkudG9wKTsNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guYm90TW9kZU1pbkJpZF0gPSAoKSA9PiBiYWNrKCk7DQogICAgICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guYm90TW9kZU1pbkJ1eV0gPSAoKSA9PiBiYWNrKCk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKCQoJy5wYWdpbmdDb250YWluZXInKS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgIGJbcC5saXN0cy5wcmV2XSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLnBhZ2luZ0NvbnRhaW5lciAucHJldjp2aXNpYmxlJykpOw0KICAgICAgICAgICAgICAgICAgICBiW3AubGlzdHMubmV4dF0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5wYWdpbmdDb250YWluZXIgLm5leHQ6dmlzaWJsZScpKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiBiOw0KICAgICAgICB9Ow0KDQogICAgLy8gVUkgdXBkYXRlIGFmdGVyIGJ1eSBub3cNCiAgICB1cGRhdGVCb3VnaHRVSSA9ICgpID0+IHsNCiAgICAgICAgdmFyIHR4QnRuID0gdHJhbnNmZXJCdG4oKTsNCiAgICAgICAgaWYgKHR4QnRuLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICBzZXRUaW1lb3V0KHVwZGF0ZUJvdWdodFVJLCA1MCk7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBsZXQgdXBkID0gKHQsIHR4KSA9PiB7DQogICAgICAgICAgICBpZiAoIXQpIHJldHVybjsNCiAgICAgICAgICAgIGxldCBhZGQgPSBgIFsgJHtwLnJlc3VsdHNbdHhdfSBdYDsNCiAgICAgICAgICAgIGxldCBodG1sID0gdC5odG1sKCk7DQogICAgICAgICAgICBpZiAoaHRtbCAmJiBodG1sLmluZGV4T2YoYWRkKSA9PSAtMSkgew0KICAgICAgICAgICAgICAgIHQuaHRtbCh0Lmh0bWwoKSArIGFkZCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICB1cGQodHhCdG4sICd0cmFuc2ZlcicpOw0KICAgICAgICB1cGQoY2x1YkJ0bigpLCAnY2x1YicpOw0KICAgICAgICB1cGQoc2VsbEJ0bigpLCAnc2VsbCcpOw0KICAgIH07DQoNCiAgICBhZGRDc3MgPSAoKSA9PiB7DQogICAgICAgIGxldCBidG4gPSAocSwgazEsIGsyLCBpbmMpID0+IGAke3F9IC4keyhpbmMgPyAnaW4nIDogJ2RlJyl9Y3JlbWVudC12YWx1ZTphZnRlciB7IGZvbnQtc2l6ZToxMHB4OyBkaXNwbGF5OmJsb2NrOyBtYXJnaW4tdG9wOi0zMHB4OyBjb250ZW50OiAnWyAke3BbazFdW2syXX0gXScgfWA7DQogICAgICAgIGxldCBzcDEgPSAoaSwgaywgaW5jKSA9PiBidG4oYC5zZWFyY2gtcHJpY2VzIC5wcmljZS1maWx0ZXI6bnRoLWNoaWxkKCR7aX0pYCwgJ3NlYXJjaCcsIGssIGluYyk7DQogICAgICAgIGxldCBzcDIgPSAoaSwgazEsIGsyKSA9PiBgJHtzcDEoaSwgazEpfSR7c3AxKGksIGsyLCB0cnVlKX1gOw0KICAgICAgICBsZXQgY3NzID0gYA0KICAgICAgICAgICAgJHtzcDIoMiwgJ2RlY01pbkJpZCcsICdpbmNNaW5CaWQnKX0NCiAgICAgICAgICAgICR7c3AyKDMsICdkZWNNYXhCaWQnLCAnaW5jTWF4QmlkJyl9DQogICAgICAgICAgICAke3NwMig1LCAnZGVjTWluQnV5JywgJ2luY01pbkJ1eScpfQ0KICAgICAgICAgICAgJHtzcDIoNiwgJ2RlY01heEJ1eScsICdpbmNNYXhCdXknKX0NCiAgICAgICAgICAgICR7YnRuKCcuRGV0YWlsUGFuZWwgPiAuYmlkT3B0aW9ucycsICdyZXN1bHRzJywgJ2RlY0JpZCcsIGZhbHNlKX0NCiAgICAgICAgICAgICR7YnRuKCcuRGV0YWlsUGFuZWwgPiAuYmlkT3B0aW9ucycsICdyZXN1bHRzJywgJ2luY0JpZCcsIHRydWUpfQ0KICAgICAgICAgICAgLnV0LW1hcmtldC1zZWFyY2gtZmlsdGVycy12aWV3IC5jYWxsLXRvLWFjdGlvbjphZnRlciB7IGNvbnRlbnQ6ICdbICR7cC5zZWFyY2guc2VhcmNofV0nfQ0KICAgICAgICAgICAgLnV0LW1hcmtldC1zZWFyY2gtZmlsdGVycy12aWV3IC5zZWFyY2gtcHJpY2UtaGVhZGVyOmZpcnN0LWNoaWxkID4gYnV0dG9uOmFmdGVyIHsgY29udGVudDogJ1sgJHtwLnNlYXJjaC5yZXNldEJpZH1dJzsgIGZvbnQtc2l6ZTogMTBweDsgZGlzcGxheTogYmxvY2sgIH0NCiAgICAgICAgICAgIC51dC1uYXZpZ2F0aW9uLWJ1dHRvbi1jb250cm9sOmFmdGVyIHsgZm9udC1zaXplOjEwcHg7IGZsb2F0OnJpZ2h0OyBtYXJnaW4tcmlnaHQ6MTJweDsgY29udGVudDogJ1sgJHtwLmJhY2t9IF0nIH0NCiAgICAgICAgICAgIC5wYWdpbmdDb250YWluZXIgLnByZXY6YWZ0ZXIgeyBmb250LXNpemU6IDEwcHg7IGRpc3BsYXk6YmxvY2s7IGNvbnRlbnQ6ICdbICR7cC5saXN0cy5wcmV2fSBdJyB9DQogICAgICAgICAgICAucGFnaW5nQ29udGFpbmVyIC5uZXh0OmFmdGVyIHsgZm9udC1zaXplOiAxMHB4OyBkaXNwbGF5OmJsb2NrOyBjb250ZW50OiAnWyAke3AubGlzdHMubmV4dH0gXScgfQ0KICAgICAgICAgICAgLmJpZEJ1dHRvbjphZnRlciB7IGNvbnRlbnQ6ICcgWyAke3AucmVzdWx0cy5iaWR9IF0nIH0NCiAgICAgICAgICAgIC5idXlCdXR0b246YmVmb3JlIHsgZmxvYXQ6cmlnaHQ7IGNvbnRlbnQ6ICcgWyAke3AucmVzdWx0cy5idXl9IF0nIH0NCiAgICAgICAgICAgIGA7DQoNCiAgICAgICAgdmFyIHN0eWxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTsNCiAgICAgICAgc3R5bGUudHlwZSA9ICJ0ZXh0L2NzcyI7DQogICAgICAgIHN0eWxlLmlubmVyVGV4dCA9IGNzczsNCiAgICAgICAgZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZChzdHlsZSk7DQogICAgfTsNCg0KICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGUgPT4gew0KICAgICAgICBpZiAoZS5jb2RlID09IHAuZW5hYmxlRGlzYWJsZSkgew0KICAgICAgICAgICAgZW5hYmxlZCA9ICFlbmFibGVkOw0KDQogICAgICAgICAgICBzZXJ2aWNlcy5Ob3RpZmljYXRpb24ucXVldWUoW2BQYWxlc25pcGUgJHtlbmFibGVkID8gIkVuYWJsZWQiIDogIkRpc2FibGVkIn1gLCBlbmFibGVkID8gVUlOb3RpZmljYXRpb25UeXBlLlBPU0lUSVZFIDogVUlOb3RpZmljYXRpb25UeXBlLk5FVVRSQUxdKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghZW5hYmxlZCkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IGFjdGlvbiA9IGtleXMoKVtlLmNvZGVdOw0KICAgICAgICBpZiAoYWN0aW9uKSBhY3Rpb24oKTsNCiAgICB9KTsNCg0KICAgIHNlcnZpY2VzLk5vdGlmaWNhdGlvbi5xdWV1ZShbIlBhbGVzbmlwZSBFbmFibGVkIiwgVUlOb3RpZmljYXRpb25UeXBlLlBPU0lUSVZFXSkNCiAgICBhZGRDc3MoKTsNCn0pKC8qQlVUVE9OUyovKTs="