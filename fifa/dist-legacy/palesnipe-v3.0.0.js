window.paletools = window.paletools || {};
window.paletools['palesnipe-3.0.0'] = "KGZ1bmN0aW9uIChidXR0b25zKSB7DQogICAgY29uc3QgVkVSU0lPTiA9ICJ2My4wLjAiOw0KDQogICAgYnV0dG9ucyA9ICQuZXh0ZW5kKHsNCiAgICAgICAgYmFjazogJ0RpZ2l0MScsDQogICAgICAgIGVuYWJsZURpc2FibGU6ICdDb21tYScsDQogICAgICAgIGxpc3RzOiB7DQogICAgICAgICAgICB1cDogJ0Fycm93VXAnLA0KICAgICAgICAgICAgZG93bjogJ0Fycm93RG93bicsDQogICAgICAgICAgICBwcmV2OiAnQXJyb3dMZWZ0JywNCiAgICAgICAgICAgIG5leHQ6ICdBcnJvd1JpZ2h0JywNCiAgICAgICAgfSwNCiAgICAgICAgc2VhcmNoOiB7DQogICAgICAgICAgICByZXNldEJpZDogJ0JhY2txdW90ZScsDQogICAgICAgICAgICBkZWNNaW5CaWQ6ICdBcnJvd0xlZnQnLA0KICAgICAgICAgICAgaW5jTWluQmlkOiAnQXJyb3dSaWdodCcsDQogICAgICAgICAgICBkZWNNYXhCaWQ6ICdFbmQnLA0KICAgICAgICAgICAgaW5jTWF4QmlkOiAnSG9tZScsDQogICAgICAgICAgICBkZWNNaW5CdXk6ICdEZWxldGUnLA0KICAgICAgICAgICAgaW5jTWluQnV5OiAnUGFnZURvd24nLA0KICAgICAgICAgICAgZGVjTWF4QnV5OiAnQXJyb3dEb3duJywNCiAgICAgICAgICAgIGluY01heEJ1eTogJ0Fycm93VXAnLA0KICAgICAgICAgICAgc2VhcmNoOiAnRGlnaXQyJywNCiAgICAgICAgICAgIGJvdE1vZGVNaW5CaWQ6ICdCcmFja2V0UmlnaHQnLA0KICAgICAgICAgICAgYm90TW9kZU1pbkJ1eTogJ0JyYWNrZXRMZWZ0JywNCiAgICAgICAgICAgIGVuYWJsZUJvdE1vZGU6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHJlc3VsdHM6IHsNCiAgICAgICAgICAgIGJpZDogJ0RpZ2l0NCcsDQogICAgICAgICAgICBidXk6ICdEaWdpdDMnLA0KICAgICAgICAgICAgdHJhbnNmZXI6ICdLZXlSJywNCiAgICAgICAgICAgIGNsdWI6ICdLZXlDJywNCiAgICAgICAgICAgIHByZXNzRW50ZXI6IHRydWUsDQogICAgICAgICAgICBhdXRvQnV5OiBmYWxzZSwNCiAgICAgICAgICAgIHByZXZlbnRCYWNrOiBmYWxzZSwNCiAgICAgICAgICAgIHNlbGw6ICdLZXlRJywNCiAgICAgICAgICAgIGRlY0JpZDogJ0RlbGV0ZScsDQogICAgICAgICAgICBpbmNCaWQ6ICdQYWdlRG93bicNCiAgICAgICAgfQ0KICAgIH0sIGJ1dHRvbnMgfHwge30pOw0KICAgIGxldCBwID0gYnV0dG9uczsNCiAgICBsZXQgZW5hYmxlZCA9IHRydWU7DQogICAgbGV0IGFwcFN0eWxlcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInN0eWxlIik7DQoNCiAgICAvLyByZXNldCBjb25zb2xlDQogICAgbGV0IGlmcmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lmcmFtZScpOw0KICAgIGlmcmFtZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoaWZyYW1lKTsNCiAgICB3aW5kb3cuY29uc29sZSA9IGlmcmFtZS5jb250ZW50V2luZG93LmNvbnNvbGU7DQoNCiAgICB3aW5kb3cuTUFYX05FV19JVEVNUyA9IE51bWJlci5NQVhfVkFMVUU7DQoNCiAgICBsZXQgX3NlbGVjdGVkUmF0aW5nID0gbnVsbDsNCiAgICBsZXQgX2lzTWFya2V0U2VhcmNoID0gZmFsc2U7DQoNCiAgICBjb25zdCBnZXRDdXJyZW50Q29udHJvbGxlciA9ICgpID0+IGdldEFwcE1haW4oKS5nZXRSb290Vmlld0NvbnRyb2xsZXIoKS5nZXRQcmVzZW50ZWRWaWV3Q29udHJvbGxlcigpLmdldEN1cnJlbnRWaWV3Q29udHJvbGxlcigpLmdldEN1cnJlbnRDb250cm9sbGVyKCk7DQoNCiAgICAvLyAkKCIudXQtZmlmYS1oZWFkZXItdmlldyIpLmFwcGVuZChgPGJ1dHRvbiBpZD0idGhyb3ciPkRFQlVHPC9idXR0b24+YCk7DQoNCiAgICAkKCIjdGhyb3ciKS5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgIHRocm93IG5ldyBFcnJvcigiZGVidWcgZXJyb3IiKTsNCiAgICB9KTsNCg0KICAgIGNvbnN0IFVUTWFya2V0U2VhcmNoRmlsdGVyc1ZpZXdfX2dlbmVyYXRlID0gVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlldy5wcm90b3R5cGUuX2dlbmVyYXRlDQogICAgVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlldy5wcm90b3R5cGUuX2dlbmVyYXRlID0gZnVuY3Rpb24gX2dlbmVyYXRlKCkgew0KICAgICAgICBmdW5jdGlvbiBjcmVhdGVDb250YWluZXIoY2hpbGQpIHsNCiAgICAgICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOw0KICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoImlubGluZS1saXN0LXNlbGVjdCIpOw0KICAgICAgICAgICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoInV0LXBsYXllci1zZWFyY2gtY29udHJvbCIpOw0KICAgICAgICAgICAgY29uc3QgaW5saW5lQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2IikNCiAgICAgICAgICAgIGlubGluZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCJpbmxpbmUtY29udGFpbmVyIik7DQogICAgICAgICAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoaW5saW5lQ29udGFpbmVyKTsNCiAgICAgICAgICAgIGNvbnN0IGlubGluZUlubGluZUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOw0KICAgICAgICAgICAgaW5saW5lQ29udGFpbmVyLmFwcGVuZENoaWxkKGlubGluZUlubGluZUNvbnRhaW5lcik7DQogICAgICAgICAgICBpbmxpbmVJbmxpbmVDb250YWluZXIuY2xhc3NMaXN0LmFkZCgidXQtcGxheWVyLXNlYXJjaC1jb250cm9sLS1pbnB1dC1jb250YWluZXIiKTsNCiAgICAgICAgICAgIGlubGluZUlubGluZUNvbnRhaW5lci5hcHBlbmRDaGlsZChjaGlsZCk7DQogICAgICAgICAgICByZXR1cm4gY29udGFpbmVyOw0KICAgICAgICB9DQoNCiAgICAgICAgVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlld19fZ2VuZXJhdGUuY2FsbCh0aGlzKTsNCiAgICAgICAgaWYgKCF0aGlzLl9nZW5lcmF0ZVBhbGVzbmlwZUNhbGxlZCkgew0KICAgICAgICAgICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7DQogICAgICAgICAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgidXQtaXRlbS1zZWFyY2gtdmlldyIpOw0KICAgICAgICAgICAgdGhpcy5fcGxheWVySWQgPSBuZXcgVVRUZXh0SW5wdXRDb250cm9sKCk7DQogICAgICAgICAgICBjb25zdCBwbGF5ZXJJZENvbnRhaW5lciA9IGNyZWF0ZUNvbnRhaW5lcih0aGlzLl9wbGF5ZXJJZC5nZXRSb290RWxlbWVudCgpKTsNCg0KICAgICAgICAgICAgdGhpcy5fcGxheWVyUmF0aW5nID0gbmV3IFVUVGV4dElucHV0Q29udHJvbCgpOw0KICAgICAgICAgICAgY29uc3QgcGxheWVyUmF0aW5nQ29udGFpbmVyID0gY3JlYXRlQ29udGFpbmVyKHRoaXMuX3BsYXllclJhdGluZy5nZXRSb290RWxlbWVudCgpKTsNCg0KICAgICAgICAgICAgbGV0IGZpbHRlcnNDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsNCiAgICAgICAgICAgIGZpbHRlcnNDb250YWluZXIuY2xhc3NMaXN0LmFkZCgic2F2ZWQtZmlsdGVycyIpOw0KDQogICAgICAgICAgICB0aGlzLl9maWx0ZXJOYW1lID0gbmV3IFVUVGV4dElucHV0Q29udHJvbCgpOw0KICAgICAgICAgICAgdGhpcy5fZmlsdGVyTmFtZS5pbml0KCk7DQogICAgICAgICAgICB0aGlzLl9maWx0ZXJOYW1lLnNldFBsYWNlaG9sZGVyKCJGaWx0ZXIgbmFtZSIpOw0KDQogICAgICAgICAgICB0aGlzLl9zYXZlRmlsdGVyQnV0dG9uID0gbmV3IFVUU3RhbmRhcmRCdXR0b25Db250cm9sKCk7DQogICAgICAgICAgICB0aGlzLl9zYXZlRmlsdGVyQnV0dG9uLmluaXQoKTsNCiAgICAgICAgICAgIHRoaXMuX3NhdmVGaWx0ZXJCdXR0b24uc2V0VGV4dCgiU2F2ZSIpOw0KICAgICAgICAgICAgdGhpcy5fc2F2ZUZpbHRlckJ1dHRvbi5hZGRUYXJnZXQodGhpcywgdGhpcy5zYXZlRmlsdGVyLCBFdmVudFR5cGUuVEFQKTsNCg0KICAgICAgICAgICAgdGhpcy5fZGVsZXRlRmlsdGVyQnV0dG9uID0gbmV3IFVUU3RhbmRhcmRCdXR0b25Db250cm9sKCk7DQogICAgICAgICAgICB0aGlzLl9kZWxldGVGaWx0ZXJCdXR0b24uaW5pdCgpOw0KICAgICAgICAgICAgdGhpcy5fZGVsZXRlRmlsdGVyQnV0dG9uLnNldFRleHQoIkRlbGV0ZSIpOw0KICAgICAgICAgICAgdGhpcy5fZGVsZXRlRmlsdGVyQnV0dG9uLmFkZFRhcmdldCh0aGlzLCB0aGlzLmRlbGV0ZUZpbHRlciwgRXZlbnRUeXBlLlRBUCk7DQoNCiAgICAgICAgICAgIHRoaXMuX3NhdmVkRmlsdGVycyA9IG5ldyBVVERyb3BEb3duQ29udHJvbCgpOw0KICAgICAgICAgICAgdGhpcy5fc2F2ZWRGaWx0ZXJzLmluaXQoKTsNCiAgICAgICAgICAgIHRoaXMuX3NhdmVkRmlsdGVycy5hZGRUYXJnZXQodGhpcywgdGhpcy5vblNhdmVkRmlsdGVyc0NoYW5nZSwgRXZlbnRUeXBlLkNIQU5HRSk7DQoNCiAgICAgICAgICAgICQoZmlsdGVyc0NvbnRhaW5lcikNCiAgICAgICAgICAgICAgICAuYXBwZW5kKHRoaXMuX2ZpbHRlck5hbWUuZ2V0Um9vdEVsZW1lbnQoKSkNCiAgICAgICAgICAgICAgICAuYXBwZW5kKHRoaXMuX3NhdmVGaWx0ZXJCdXR0b24uZ2V0Um9vdEVsZW1lbnQoKSkNCiAgICAgICAgICAgICAgICAuYXBwZW5kKHRoaXMuX2RlbGV0ZUZpbHRlckJ1dHRvbi5nZXRSb290RWxlbWVudCgpKQ0KICAgICAgICAgICAgICAgIC5hcHBlbmQodGhpcy5fc2F2ZWRGaWx0ZXJzLmdldFJvb3RFbGVtZW50KCkpOw0KDQoNCiAgICAgICAgICAgICQoY29udGFpbmVyKQ0KICAgICAgICAgICAgICAgIC5hcHBlbmQoZmlsdGVyc0NvbnRhaW5lcikNCiAgICAgICAgICAgICAgICAuYXBwZW5kKHBsYXllcklkQ29udGFpbmVyKQ0KICAgICAgICAgICAgICAgIC5hcHBlbmQocGxheWVyUmF0aW5nQ29udGFpbmVyKTsNCiAgICAgICAgICAgICQoY29udGFpbmVyKS5pbnNlcnRCZWZvcmUoJCgiLnV0LWl0ZW0tc2VhcmNoLXZpZXciLCB0aGlzLl9fcm9vdCkpOw0KDQogICAgICAgICAgICB0aGlzLl9wbGF5ZXJJZC5pbml0KCk7DQogICAgICAgICAgICB0aGlzLl9wbGF5ZXJJZC5zZXRQbGFjZWhvbGRlcigiUGxheWVyIElEIik7DQogICAgICAgICAgICB0aGlzLl9wbGF5ZXJJZC5zZXRNYXhMZW5ndGgoMjUpOw0KICAgICAgICAgICAgdGhpcy5fcGxheWVySWQuYWRkVGFyZ2V0KHRoaXMsIHRoaXMuaGFuZGxlUGxheWVySWRDaGFuZ2UsIEV2ZW50VHlwZS5DSEFOR0UpOw0KICAgICAgICAgICAgdGhpcy5fcGxheWVyUmF0aW5nLmluaXQoKTsNCiAgICAgICAgICAgIHRoaXMuX3BsYXllclJhdGluZy5zZXRQbGFjZWhvbGRlcigiUGxheWVyIFJhdGluZyIpOw0KICAgICAgICAgICAgdGhpcy5fcGxheWVyUmF0aW5nLnNldE1heExlbmd0aCgzKTsNCiAgICAgICAgICAgIHRoaXMuX3BsYXllclJhdGluZy5hZGRUYXJnZXQodGhpcywgdGhpcy5oYW5kbGVQbGF5ZXJSYXRpbmdDaGFuZ2UsIEV2ZW50VHlwZS5DSEFOR0UpOw0KDQogICAgICAgICAgICB0aGlzLmxvYWRTYXZlZEZpbHRlcnMoKTsNCg0KICAgICAgICAgICAgdGhpcy5fZ2VuZXJhdGVQYWxlc25pcGVDYWxsZWQgPSB0cnVlOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlldy5wcm90b3R5cGUuZ2V0U3RvcmVkRmlsdGVycyA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgY29uc3QgZGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJwYWxldG9vbHM6c2VhcmNoRmlsdGVycyIpOw0KICAgICAgICBpZiAoIWRhdGEpIHJldHVybiB7fTsNCiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoYXRvYihkYXRhKSkgfHwge307DQogICAgfQ0KDQogICAgVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlldy5wcm90b3R5cGUuc2F2ZUZpbHRlcnMgPSBmdW5jdGlvbiAoZmlsdGVycykgew0KICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgicGFsZXRvb2xzOnNlYXJjaEZpbHRlcnMiLCBidG9hKEpTT04uc3RyaW5naWZ5KGZpbHRlcnMpKSk7DQogICAgfQ0KDQogICAgVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlldy5wcm90b3R5cGUubG9hZFNhdmVkRmlsdGVycyA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgY29uc3Qgc2VhcmNoRmlsdGVycyA9IHRoaXMuZ2V0U3RvcmVkRmlsdGVycygpOw0KICAgICAgICBsZXQgZmlsdGVycyA9IFt7IGxhYmVsOiAnLS0gU2VsZWN0IGEgZmlsdGVyIHRvIGxvYWQgLS0nLCB2YWx1ZTogJycgfV07DQogICAgICAgIGZvciAobGV0IGZpbHRlcktleSBvZiBPYmplY3Qua2V5cyhzZWFyY2hGaWx0ZXJzKS5zb3J0KCkpIHsNCiAgICAgICAgICAgIGZpbHRlcnMucHVzaCh7IGxhYmVsOiBzZWFyY2hGaWx0ZXJzW2ZpbHRlcktleV0ubmFtZSwgdmFsdWU6IGZpbHRlcktleSB9KTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLl9zYXZlZEZpbHRlcnMuc2V0T3B0aW9ucyhmaWx0ZXJzKTsNCiAgICB9DQoNCiAgICBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3LnByb3RvdHlwZS5zYXZlRmlsdGVyID0gZnVuY3Rpb24gKCkgew0KICAgICAgICBjb25zdCBjb250cm9sbGVyID0gZ2V0Q3VycmVudENvbnRyb2xsZXIoKTsNCiAgICAgICAgaWYgKGNvbnRyb2xsZXIgaW5zdGFuY2VvZiBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3Q29udHJvbGxlcikgew0KICAgICAgICAgICAgY29uc3Qgc2VhcmNoQ3JpdGVyaWEgPSBjb250cm9sbGVyLl92aWV3bW9kZWwuc2VhcmNoQ3JpdGVyaWE7DQogICAgICAgICAgICBjb25zdCBuYW1lID0gdGhpcy5fZmlsdGVyTmFtZS5nZXRWYWx1ZSgpOw0KICAgICAgICAgICAgY29uc3Qga2V5ID0gbmFtZS5yZXBsYWNlKC9bXmEtejAtOV0vZ2ksICdfJykudG9Mb3dlckNhc2UoKTsNCiAgICAgICAgICAgIGNvbnN0IGZpbHRlcnMgPSB0aGlzLmdldFN0b3JlZEZpbHRlcnMoKTsNCiAgICAgICAgICAgIHNlYXJjaENyaXRlcmlhLnJhdGluZyA9IHRoaXMuX3BsYXllclJhdGluZy5nZXRWYWx1ZSgpOw0KICAgICAgICAgICAgZmlsdGVyc1trZXldID0geyBuYW1lOiBuYW1lLCBjcml0ZXJpYTogc2VhcmNoQ3JpdGVyaWEgfTsNCiAgICAgICAgICAgIHRoaXMuc2F2ZUZpbHRlcnMoZmlsdGVycyk7DQogICAgICAgICAgICB0aGlzLmxvYWRTYXZlZEZpbHRlcnMoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIFVUTWFya2V0U2VhcmNoRmlsdGVyc1ZpZXcucHJvdG90eXBlLmRlbGV0ZUZpbHRlciA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgY29uc3QgY29udHJvbGxlciA9IGdldEN1cnJlbnRDb250cm9sbGVyKCk7DQogICAgICAgIGlmIChjb250cm9sbGVyIGluc3RhbmNlb2YgVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlld0NvbnRyb2xsZXIpIHsNCiAgICAgICAgICAgIGNvbnN0IGZpbHRlcktleSA9IHRoaXMuX3NhdmVkRmlsdGVycy5nZXRWYWx1ZSgpOw0KICAgICAgICAgICAgaWYgKCFmaWx0ZXJLZXkpIHJldHVybjsNCiAgICAgICAgICAgIGNvbnN0IGZpbHRlcnMgPSB0aGlzLmdldFN0b3JlZEZpbHRlcnMoKTsNCiAgICAgICAgICAgIGRlbGV0ZSBmaWx0ZXJzW2ZpbHRlcktleV07DQogICAgICAgICAgICB0aGlzLnNhdmVGaWx0ZXJzKGZpbHRlcnMpOw0KICAgICAgICAgICAgdGhpcy5sb2FkU2F2ZWRGaWx0ZXJzKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3LnByb3RvdHlwZS5sb2FkRmlsdGVyID0gZnVuY3Rpb24gKGZpbHRlcikgew0KICAgICAgICBjb25zdCBjb250cm9sbGVyID0gZ2V0Q3VycmVudENvbnRyb2xsZXIoKTsNCiAgICAgICAgaWYgKGNvbnRyb2xsZXIgaW5zdGFuY2VvZiBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3Q29udHJvbGxlcikgew0KICAgICAgICAgICAgaWYgKGZpbHRlci5jcml0ZXJpYS5kZWZJZCAmJiBmaWx0ZXIuY3JpdGVyaWEuZGVmSWQubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIHRoaXMuX3BsYXllcklkLnNldFZhbHVlKGZpbHRlci5jcml0ZXJpYS5kZWZJZFswXSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLl9wbGF5ZXJSYXRpbmcuc2V0VmFsdWUoZmlsdGVyLmNyaXRlcmlhLnJhdGluZyk7DQogICAgICAgICAgICBfc2VsZWN0ZWRSYXRpbmcgPSBmaWx0ZXIuY3JpdGVyaWEucmF0aW5nOw0KICAgICAgICAgICAgZm9yIChsZXQga2V5IG9mIE9iamVjdC5rZXlzKGZpbHRlci5jcml0ZXJpYSkpIHsNCiAgICAgICAgICAgICAgICBjb250cm9sbGVyLl92aWV3bW9kZWwuc2VhcmNoQ3JpdGVyaWFba2V5XSA9IGZpbHRlci5jcml0ZXJpYVtrZXldOw0KICAgICAgICAgICAgICAgIHRoaXMuc2V0RmlsdGVycyhjb250cm9sbGVyLl92aWV3bW9kZWwpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgY29uc3QgVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlld19zZXRGaWx0ZXJzID0gVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlldy5wcm90b3R5cGUuc2V0RmlsdGVyczsNCiAgICBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3LnByb3RvdHlwZS5zZXRGaWx0ZXJzID0gZnVuY3Rpb24gc2V0RmlsdGVycyhlLCB0KSB7DQogICAgICAgIGlmIChlLnNlYXJjaENyaXRlcmlhLmRlZklkICYmIGUuc2VhcmNoQ3JpdGVyaWEuZGVmSWQubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgdGhpcy5wbGF5ZXJJZC5zZXRWYWx1ZShlLnNlYXJjaENyaXRlcmlhLmRlZklkWzBdKQ0KICAgICAgICB9DQogICAgICAgIHRoaXMuX3BsYXllclJhdGluZy5zZXRWYWx1ZShfc2VsZWN0ZWRSYXRpbmcpOw0KICAgICAgICBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3X3NldEZpbHRlcnMuY2FsbCh0aGlzLCBlLCB0KTsNCiAgICB9DQoNCiAgICBjb25zdCBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3X2Rlc3Ryb3lHZW5lcmF0ZWRFbGVtZW50cyA9IFVUTWFya2V0U2VhcmNoRmlsdGVyc1ZpZXcucHJvdG90eXBlLmRlc3Ryb3lHZW5lcmF0ZWRFbGVtZW50czsNCiAgICBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3LnByb3RvdHlwZS5kZXN0cm95R2VuZXJhdGVkRWxlbWVudHMgPSBmdW5jdGlvbiBkZXN0cm95R2VuZXJhdGVkRWxlbWVudHMoKSB7DQogICAgICAgIFVUTWFya2V0U2VhcmNoRmlsdGVyc1ZpZXdfZGVzdHJveUdlbmVyYXRlZEVsZW1lbnRzLmNhbGwodGhpcyk7DQogICAgICAgIHRoaXMuX3BsYXllcklkLmRlc3Ryb3koKTsNCiAgICAgICAgdGhpcy5fcGxheWVyUmF0aW5nLmRlc3Ryb3koKTsNCiAgICAgICAgdGhpcy5fZmlsdGVyTmFtZS5kZXN0cm95KCk7DQogICAgICAgIHRoaXMuX3NhdmVGaWx0ZXJCdXR0b24uZGVzdHJveSgpOw0KICAgICAgICB0aGlzLl9kZWxldGVGaWx0ZXJCdXR0b24uZGVzdHJveSgpOw0KICAgICAgICB0aGlzLl9zYXZlZEZpbHRlcnMuZGVzdHJveSgpOw0KICAgIH0NCg0KICAgIFVUTWFya2V0U2VhcmNoRmlsdGVyc1ZpZXcucHJvdG90eXBlLmhhbmRsZVBsYXllcklkQ2hhbmdlID0gZnVuY3Rpb24gKF8sIF9fLCBlbGVtKSB7DQogICAgICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBnZXRDdXJyZW50Q29udHJvbGxlcigpOw0KICAgICAgICBpZiAoY29udHJvbGxlciBpbnN0YW5jZW9mIFVUTWFya2V0U2VhcmNoRmlsdGVyc1ZpZXdDb250cm9sbGVyKSB7DQogICAgICAgICAgICBjb250cm9sbGVyLl92aWV3bW9kZWwuc2VhcmNoQ3JpdGVyaWEuZGVmSWQgPSBbZWxlbS52YWx1ZV07DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3LnByb3RvdHlwZS5oYW5kbGVQbGF5ZXJSYXRpbmdDaGFuZ2UgPSBmdW5jdGlvbiAoXywgX18sIGVsZW0pIHsNCiAgICAgICAgX3NlbGVjdGVkUmF0aW5nID0gZWxlbS52YWx1ZTsNCiAgICB9DQoNCiAgICBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3LnByb3RvdHlwZS5vblNhdmVkRmlsdGVyc0NoYW5nZSA9IGZ1bmN0aW9uIChfLCBfXywgZWxlbSkgew0KICAgICAgICBjb25zdCBmaWx0ZXJzID0gdGhpcy5nZXRTdG9yZWRGaWx0ZXJzKCk7DQogICAgICAgIGlmIChmaWx0ZXJzW2VsZW0udmFsdWVdKSB7DQogICAgICAgICAgICB0aGlzLmxvYWRGaWx0ZXIoZmlsdGVyc1tlbGVtLnZhbHVlXSk7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICBjb25zdCBjb250cm9sbGVyID0gZ2V0Q3VycmVudENvbnRyb2xsZXIoKTsNCiAgICAgICAgICAgIGlmIChjb250cm9sbGVyIGluc3RhbmNlb2YgVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlld0NvbnRyb2xsZXIpIHsNCiAgICAgICAgICAgICAgICBjb250cm9sbGVyLl9lUmVzZXRTZWxlY3RlZCgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgY29uc3QgVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlld0NvbnRyb2xsZXJfX2VSZXNldFNlbGVjdGVkID0gVVRNYXJrZXRTZWFyY2hGaWx0ZXJzVmlld0NvbnRyb2xsZXIucHJvdG90eXBlLl9lUmVzZXRTZWxlY3RlZDsNCiAgICBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3Q29udHJvbGxlci5wcm90b3R5cGUuX2VSZXNldFNlbGVjdGVkID0gZnVuY3Rpb24gX2VSZXNldFNlbGVjdGVkKCkgew0KICAgICAgICB0aGlzLmdldFZpZXcoKS5fcGxheWVySWQuY2xlYXIoKTsNCiAgICAgICAgdGhpcy5nZXRWaWV3KCkuX3BsYXllclJhdGluZy5jbGVhcigpOw0KICAgICAgICB0aGlzLmdldFZpZXcoKS5fZmlsdGVyTmFtZS5jbGVhcigpOw0KICAgICAgICBfc2VsZWN0ZWRSYXRpbmcgPSBudWxsOw0KICAgICAgICBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3Q29udHJvbGxlcl9fZVJlc2V0U2VsZWN0ZWQuY2FsbCh0aGlzKTsNCiAgICB9DQoNCiAgICBjb25zdCBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3X19lU2VhcmNoQnV0dG9uU2VsZWN0ZWQgPSBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3LnByb3RvdHlwZS5fZVNlYXJjaEJ1dHRvblNlbGVjdGVkOw0KICAgIFVUTWFya2V0U2VhcmNoRmlsdGVyc1ZpZXcucHJvdG90eXBlLl9lU2VhcmNoQnV0dG9uU2VsZWN0ZWQgPSBmdW5jdGlvbiBfZVNlYXJjaEJ1dHRvblNlbGVjdGVkKCkgew0KICAgICAgICBfaXNNYXJrZXRTZWFyY2ggPSB0cnVlOw0KICAgICAgICBVVE1hcmtldFNlYXJjaEZpbHRlcnNWaWV3X19lU2VhcmNoQnV0dG9uU2VsZWN0ZWQuY2FsbCh0aGlzKTsNCiAgICB9DQoNCiAgICBVVFBhZ2luYXRlZEl0ZW1MaXN0Vmlldy5wcm90b3R5cGUuc2V0SXRlbXMgPSBmdW5jdGlvbiAoZSwgaSkgew0KICAgICAgICB2YXIgbyA9IHRoaXM7DQogICAgICAgIHRoaXMucmVtb3ZlTGlzdFJvd3MoKTsNCg0KICAgICAgICBlLmZvckVhY2goZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgICAgIGlmIChzaG91bGRSZW5kZXJJdGVtKGUpKSB7DQogICAgICAgICAgICAgICAgdmFyIHQgPSBuZXcgVVRJdGVtVGFibGVDZWxsVmlldzsNCiAgICAgICAgICAgICAgICB0LnNldERhdGEoZSwgdm9pZCAwLCB2b2lkIDAsIGkpLA0KICAgICAgICAgICAgICAgICAgICBvLmxpc3RSb3dzLnB1c2godCkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQoNCiAgICAgICAgX2lzTWFya2V0U2VhcmNoID0gZmFsc2U7DQoNCiAgICAgICAgcmV0dXJuIHRoaXMubGlzdFJvd3M7DQogICAgfQ0KDQogICAgY29uc3QgVVRNYXJrZXRTZWFyY2hWaWV3X19nZW5lcmF0ZSA9IFVUTWFya2V0U2VhcmNoVmlldy5wcm90b3R5cGUuX2dlbmVyYXRlOw0KICAgIFVUTWFya2V0U2VhcmNoVmlldy5wcm90b3R5cGUuX2dlbmVyYXRlID0gZnVuY3Rpb24gX2dlbmVyYXRlKCkgew0KICAgICAgICBVVE1hcmtldFNlYXJjaFZpZXdfX2dlbmVyYXRlLmNhbGwodGhpcyk7DQogICAgICAgIGlmICghdGhpcy5fZ2VuZXJhdGVQYWxlc25pcGVDYWxsZWQpIHsNCiAgICAgICAgICAgIHRoaXMuX21pbk1heFByaWNlQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7DQogICAgICAgICAgICB0aGlzLl9taW5NYXhQcmljZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCJtaW4tbWF4LXByaWNlcyIpOw0KICAgICAgICAgICAgdGhpcy5fbWluUHJpY2VUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpOw0KICAgICAgICAgICAgdGhpcy5fbWluUHJpY2VUZXh0LmNsYXNzTGlzdC5hZGQoIm1pbi1wcmljZS12YWx1ZSIpOw0KICAgICAgICAgICAgdGhpcy5fbWF4UHJpY2VUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3BhbiIpOw0KICAgICAgICAgICAgdGhpcy5fbWF4UHJpY2VUZXh0LmNsYXNzTGlzdC5hZGQoIm1heC1wcmljZS12YWx1ZSIpOw0KICAgICAgICAgICAgY29uc3QgbWluUHJpY2VDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7DQogICAgICAgICAgICBtaW5QcmljZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCJtaW4tcHJpY2UiKTsNCiAgICAgICAgICAgICQobWluUHJpY2VDb250YWluZXIpDQogICAgICAgICAgICAgICAgLmFwcGVuZCgnPHNwYW4gY2xhc3M9Im1pbi1wcmljZS1sYWJlbCI+TWluIFByaWNlPC9zcGFuPicpDQogICAgICAgICAgICAgICAgLmFwcGVuZCh0aGlzLl9taW5QcmljZVRleHQpOw0KICAgICAgICAgICAgY29uc3QgbWF4UHJpY2VDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJzcGFuIik7DQogICAgICAgICAgICBtYXhQcmljZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCJtYXgtcHJpY2UiKTsNCiAgICAgICAgICAgICQobWF4UHJpY2VDb250YWluZXIpDQogICAgICAgICAgICAgICAgLmFwcGVuZCgnPHNwYW4gY2xhc3M9Im1pbi1wcmljZS1sYWJlbCI+TWluIFByaWNlPC9zcGFuPicpDQogICAgICAgICAgICAgICAgLmFwcGVuZCh0aGlzLl9tYXhQcmljZVRleHQpOw0KDQoNCiAgICAgICAgICAgICQodGhpcy5fbWluTWF4UHJpY2VDb250YWluZXIpDQogICAgICAgICAgICAgICAgLmFwcGVuZChtaW5QcmljZUNvbnRhaW5lcikNCiAgICAgICAgICAgICAgICAuYXBwZW5kKG1heFByaWNlQ29udGFpbmVyKQ0KICAgICAgICAgICAgICAgIC5pbnNlcnRCZWZvcmUodGhpcy5fbGlzdC5nZXRSb290RWxlbWVudCgpKTsNCiAgICAgICAgICAgIHRoaXMuX2dlbmVyYXRlUGFsZXNuaXBlQ2FsbGVkID0gdHJ1ZTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIGNvbnN0IFVUTWFya2V0U2VhcmNoVmlld19zZXRJdGVtcyA9IFVUTWFya2V0U2VhcmNoVmlldy5wcm90b3R5cGUuc2V0SXRlbXM7DQogICAgVVRNYXJrZXRTZWFyY2hWaWV3LnByb3RvdHlwZS5zZXRJdGVtcyA9IGZ1bmN0aW9uIHNldEl0ZW1zKGUsIHQpIHsNCiAgICAgICAgaWYgKHRoaXMuX3N1cGVydmlldw0KICAgICAgICAgICAgJiYgdGhpcy5fc3VwZXJ2aWV3Ll9zdXBlcnZpZXcNCiAgICAgICAgICAgICYmIHRoaXMuX3N1cGVydmlldy5fc3VwZXJ2aWV3Ll9yVmlldyBpbnN0YW5jZW9mIFVUTmF2aWdhdGlvbkNvbnRhaW5lclZpZXcpIHsNCiAgICAgICAgICAgIGxldCBtaW5CdXlOb3dQcmljZSA9IE51bWJlci5NQVhfVkFMVUU7DQogICAgICAgICAgICBsZXQgbWF4QnV5Tm93UHJpY2UgPSAwOw0KICAgICAgICAgICAgZm9yIChsZXQgZW50aXR5IG9mIGUpIHsNCiAgICAgICAgICAgICAgICBpZiAoZW50aXR5Ll9hdWN0aW9uLmJ1eU5vd1ByaWNlID4gbWF4QnV5Tm93UHJpY2UpIHsNCiAgICAgICAgICAgICAgICAgICAgbWF4QnV5Tm93UHJpY2UgPSBlbnRpdHkuX2F1Y3Rpb24uYnV5Tm93UHJpY2U7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChlbnRpdHkuX2F1Y3Rpb24uYnV5Tm93UHJpY2UgPCBtaW5CdXlOb3dQcmljZSkgew0KICAgICAgICAgICAgICAgICAgICBtaW5CdXlOb3dQcmljZSA9IGVudGl0eS5fYXVjdGlvbi5idXlOb3dQcmljZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aGlzLl9taW5QcmljZVRleHQudGV4dENvbnRlbnQgPSBtaW5CdXlOb3dQcmljZTsNCiAgICAgICAgICAgIHRoaXMuX21heFByaWNlVGV4dC50ZXh0Q29udGVudCA9IG1heEJ1eU5vd1ByaWNlOw0KICAgICAgICAgICAgJCh0aGlzLl9taW5NYXhQcmljZUNvbnRhaW5lcikuc2hvdygpOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgJCh0aGlzLl9taW5NYXhQcmljZUNvbnRhaW5lcikuaGlkZSgpOw0KICAgICAgICB9DQoNCiAgICAgICAgVVRNYXJrZXRTZWFyY2hWaWV3X3NldEl0ZW1zLmNhbGwodGhpcywgZSwgdCk7DQogICAgfQ0KDQogICAgVVRJdGVtVGFibGVDZWxsVmlldy5wcm90b3R5cGUuX29sZFJlbmRlciA9IFVUSXRlbVRhYmxlQ2VsbFZpZXcucHJvdG90eXBlLnJlbmRlcjsNCiAgICBVVEl0ZW1UYWJsZUNlbGxWaWV3LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoZSkgew0KICAgICAgICB0aGlzLl9vbGRSZW5kZXIoKTsNCiAgICAgICAgaWYgKHRoaXMuZGF0YS5pc1BsYXllcigpKSB7DQogICAgICAgICAgICAkKCIudXQtaXRlbS12aWV3LS1tYWluIiwgdGhpcy5fX2VudGl0eUNvbnRhaW5lcikuYXBwZW5kKGA8c3BhbiBjbGFzcz0icGxheWVyLWRlZmluaXRpb24taWQiPiR7dGhpcy5kYXRhLmRlZmluaXRpb25JZH08L3NwYW4+YCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBzaG91bGRSZW5kZXJJdGVtKGl0ZW0pIHsNCiAgICAgICAgbGV0IHJhdGluZyA9IF9zZWxlY3RlZFJhdGluZzsNCg0KICAgICAgICBpZiAoIV9pc01hcmtldFNlYXJjaCkgcmV0dXJuIHRydWU7DQogICAgICAgIGlmICghcmF0aW5nKSByZXR1cm4gdHJ1ZTsNCg0KICAgICAgICBpZiAocmF0aW5nLmNoYXJBdCgwKSA9PT0gIisiKSB7DQogICAgICAgICAgICByYXRpbmcgPSBwYXJzZUludChyYXRpbmcuc3Vic3RyKDEpKTsNCiAgICAgICAgICAgIHJldHVybiBpdGVtLnJhdGluZyA+PSByYXRpbmc7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSBpZiAocmF0aW5nLmNoYXJBdCgwKSA9PT0gIi0iKSB7DQogICAgICAgICAgICByYXRpbmcgPSBwYXJzZUludChyYXRpbmcuc3Vic3RyKDEpKTsNCiAgICAgICAgICAgIHJldHVybiBpdGVtLnJhdGluZyA8PSByYXRpbmc7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgICByYXRpbmcgPSBwYXJzZUludChyYXRpbmcpOw0KICAgICAgICAgICAgcmV0dXJuIGl0ZW0ucmF0aW5nID09IHJhdGluZzsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIFVUSXRlbURvbWFpblJlcG9zaXRvcnkucHJvdG90eXBlLmlzUGlsZUZ1bGwgPSBmdW5jdGlvbiAoZSkgew0KICAgICAgICB2YXIgdCA9IDANCiAgICAgICAgICAgICwgaSA9IHRoaXMucGlsZVNpemVzLmdldChlKTsNCiAgICAgICAgc3dpdGNoIChlKSB7DQogICAgICAgICAgICBjYXNlIEl0ZW1QaWxlLlBVUkNIQVNFRDoNCiAgICAgICAgICAgICAgICB0ID0gdGhpcy51bmFzc2lnbmVkLmxlbmd0aDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgSXRlbVBpbGUuVFJBTlNGRVI6DQogICAgICAgICAgICAgICAgdCA9IHRoaXMudHJhbnNmZXIubGVuZ3RoOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSBJdGVtUGlsZS5JTkJPWDoNCiAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgIGNhc2UgSXRlbVBpbGUuQ0xVQjoNCiAgICAgICAgICAgICAgICByZXR1cm4gITENCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gKGkgfHwgMCkgPD0gdA0KICAgIH0NCg0KICAgIGNvbnN0DQogICAgICAgIGwgPSBjb25zb2xlLmxvZywNCiAgICAgICAgbG9jID0gd2luZG93LnNlcnZpY2VzLkxvY2FsaXphdGlvbiwNCiAgICAgICAgZGlzcGF0Y2hNb3VzZUV2ZW50ID0gKCR0YXJnZXQsIGV2ZW50TmFtZSkgPT4gew0KICAgICAgICAgICAgaWYgKCR0YXJnZXQubGVuZ3RoID09IDApIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIGNvbnN0IG1vdXNlRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnTW91c2VFdmVudHMnKTsNCiAgICAgICAgICAgIG1vdXNlRXZlbnQuaW5pdEV2ZW50KGV2ZW50TmFtZSk7DQogICAgICAgICAgICAkdGFyZ2V0WzBdLmRpc3BhdGNoRXZlbnQobW91c2VFdmVudCk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSwNCiAgICAgICAgbW91c2VEb3duID0gdGFyZ2V0ID0+IGRpc3BhdGNoTW91c2VFdmVudCh0YXJnZXQsICdtb3VzZWRvd24nKSwNCiAgICAgICAgbW91c2VVcCA9IHRhcmdldCA9PiBkaXNwYXRjaE1vdXNlRXZlbnQodGFyZ2V0LCAnbW91c2V1cCcpLA0KICAgICAgICBtb3VzZUNsaWNrID0gKHRhcmdldCwgZGVsYXksIGNhbGxiYWNrKSA9PiB7DQogICAgICAgICAgICBpZiAoZGVsYXkpIHsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobW91c2VDbGljayh0YXJnZXQpKTsNCiAgICAgICAgICAgICAgICB9LCBkZWxheSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbW91c2VEb3duKHRhcmdldCkgJiYgbW91c2VVcCh0YXJnZXQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBidXlOb3cgPSAoY2FsbGJhY2spID0+IHsNCiAgICAgICAgICAgIGlmIChtb3VzZUNsaWNrKGJ1eUJ0bigpKSkgew0KICAgICAgICAgICAgICAgIGlmIChwLnJlc3VsdHMucHJlc3NFbnRlcikgew0KICAgICAgICAgICAgICAgICAgICB0cnlQcmVzc09rQnRuKGNhbGxiYWNrKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHRyeVByZXNzT2tCdG4gPSAoY2FsbGJhY2spID0+IHsNCiAgICAgICAgICAgIGlmICghbW91c2VDbGljayhlbnRlckJ0bigpKSkgew0KICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykgew0KICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGNhbGxiYWNrKGZhbHNlKSwgMCk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgc2V0VGltZW91dCh0cnlQcmVzc09rQnRuLCAxMCk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7DQogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHRydWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB1cGRhdGVCb3VnaHRVSSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBiYWNrID0gKCkgPT4gew0KICAgICAgICAgICAgbCgnYmFjaycpOw0KICAgICAgICAgICAgaWYgKCFtb3VzZUNsaWNrKGJhY2tCdG4oKSkpIHsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGJhY2ssIDEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHNlYXJjaCA9ICgpID0+IHsNCiAgICAgICAgICAgIG1vdXNlQ2xpY2soc2VhcmNoQnRuKCkpOw0KICAgICAgICAgICAgaWYgKHAucmVzdWx0cy5hdXRvQnV5KSB7DQogICAgICAgICAgICAgICAgaWYgKHNlYXJjaFJlc3VsdHMoKSA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIGwoJ3Jlc2VhcmNoaW5nJyk7DQogICAgICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoc2VhcmNoLCAxMCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBsKCQoIi51dC1uby1yZXN1bHRzLXZpZXciKS5sZW5ndGgpOw0KICAgICAgICAgICAgICAgICAgICBpZiAoJCgiLnV0LW5vLXJlc3VsdHMtdmlldyIpLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGwoJ25vIHJlc3VsdHMnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2soKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGwoJ2J1eWluZycpOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnV5Tm93KChib3VnaHQpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYm91Z2h0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vdXNlQ2xpY2sodHJhbnNmZXJCdG4oKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgdHJhbnNmZXJCdG4gPSAoKSA9PiAkKGAudXQtYnV0dG9uLWdyb3VwID4gYnV0dG9uOmNvbnRhaW5zKCcke2xvYy5sb2NhbGl6ZSgnaW5mb3BhbmVsLmxhYmVsLnNlbmRUcmFkZVBpbGUnKX0nKWApLA0KICAgICAgICBjbHViQnRuID0gKCkgPT4gJChgLnV0LWJ1dHRvbi1ncm91cCA+IGJ1dHRvbjpjb250YWlucygnJHtsb2MubG9jYWxpemUoJ2luZm9wYW5lbC5sYWJlbC5zdG9yZUluQ2x1YicpfScpYCksDQogICAgICAgIHNlbGxCdG4gPSAoKSA9PiAkKGAudXQtYnV0dG9uLWdyb3VwID4gYnV0dG9uOmNvbnRhaW5zKCcke2xvYy5sb2NhbGl6ZSgnaW5mb3BhbmVsLmxhYmVsLmRpc2NhcmQnKX0nKWApLA0KICAgICAgICBidXlCdG4gPSAoKSA9PiAkKCcuYnV5QnV0dG9uJyksDQogICAgICAgIGJhY2tCdG4gPSAoKSA9PiAkKCcudXQtbmF2aWdhdGlvbi1idXR0b24tY29udHJvbCcpLA0KICAgICAgICBlbnRlckJ0biA9ICgpID0+ICQoJy5lYS1kaWFsb2ctdmlldyAudXQtYnV0dG9uLWdyb3VwIGJ1dHRvbjplcSgwKScpLA0KICAgICAgICBzZWFyY2hCdG4gPSAoKSA9PiAkKCcuYnV0dG9uLWNvbnRhaW5lciAuYnRuLXN0YW5kYXJkLmNhbGwtdG8tYWN0aW9uJyksDQogICAgICAgIHNlYXJjaFJlc3VsdHMgPSAoKSA9PiAkKCcuU2VhcmNoUmVzdWx0cycpLmxlbmd0aCwNCg0KDQogICAgICAgIGtleXMgPSAoKSA9PiB7DQogICAgICAgICAgICBsZXQgYiA9IHt9Ow0KDQogICAgICAgICAgICBiW3AuYmFja10gPSAoKSA9PiBiYWNrKCk7DQoNCiAgICAgICAgICAgIGlmICgkKCcudXQtbWFya2V0LXNlYXJjaC1maWx0ZXJzLXZpZXcnKS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5kZWNNaW5CaWRdID0gKCkgPT4gbW91c2VDbGljaygkKCcuZGVjcmVtZW50LXZhbHVlJykpOw0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guaW5jTWluQmlkXSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmluY3JlbWVudC12YWx1ZScpKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmRlY01heEJpZF0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5kZWNyZW1lbnQtdmFsdWU6ZXEoMSknKSk7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5pbmNNYXhCaWRdID0gKCkgPT4gbW91c2VDbGljaygkKCcuaW5jcmVtZW50LXZhbHVlOmVxKDEpJykpOw0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guZGVjTWluQnV5XSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmRlY3JlbWVudC12YWx1ZTplcSgyKScpKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmluY01pbkJ1eV0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5pbmNyZW1lbnQtdmFsdWU6ZXEoMiknKSk7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5kZWNNYXhCdXldID0gKCkgPT4gbW91c2VDbGljaygkKCcuZGVjcmVtZW50LXZhbHVlOmVxKDMpJykpOw0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guaW5jTWF4QnV5XSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmluY3JlbWVudC12YWx1ZTplcSgzKScpKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLnNlYXJjaF0gPSAoKSA9PiBzZWFyY2goKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLnJlc2V0QmlkXSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLnNlYXJjaC1wcmljZS1oZWFkZXIgPiBidXR0b246Zmlyc3QnKSk7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5ib3RNb2RlTWluQmlkXSA9ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGIuc2VhcmNoLmVuYWJsZUJvdE1vZGUgJiYgYltwLnNlYXJjaC5pbmNNaW5CaWRdKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmJvdE1vZGVNaW5CdXldID0gKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICBpZiAoYi5zZWFyY2guZW5hYmxlQm90TW9kZSAmJiBiW3Auc2VhcmNoLmluY01pbkJ1eV0oKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc2VhcmNoKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICBsZXQgaXRlbXMgPSAkKCIubGlzdEZVVEl0ZW0iKTsNCiAgICAgICAgICAgICAgICBsZXQgaXRlbXNFeGlzdHMgPSBpdGVtcy5sZW5ndGggPiAwOw0KICAgICAgICAgICAgICAgIGxldCBpdGVtc0NvbnRhaW5lciA9IGl0ZW1zLnBhcmVudHMoJy5wYWdpbmF0ZWQsIC51dC13YXRjaC1saXN0LXZpZXcsIC51dC10cmFuc2Zlci1saXN0LXZpZXcnKTsNCiAgICAgICAgICAgICAgICBpZiAoaXRlbXNDb250YWluZXIubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgaXRlbXNDb250YWluZXIgPSBpdGVtcy5wYXJlbnQoKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoaXRlbXNFeGlzdHMgJiYgJCgnLkRldGFpbFBhbmVsID4gLmJpZE9wdGlvbnMnKS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgIGJbcC5yZXN1bHRzLmJpZF0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5iaWRCdXR0b24nKSk7DQogICAgICAgICAgICAgICAgICAgIGJbcC5yZXN1bHRzLmJ1eV0gPSAoKSA9PiBidXlOb3coKTsNCiAgICAgICAgICAgICAgICAgICAgYltwLnJlc3VsdHMuZGVjQmlkXSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmJpZE9wdGlvbnMgLmRlY3JlbWVudC12YWx1ZScpKTsNCiAgICAgICAgICAgICAgICAgICAgYltwLnJlc3VsdHMuaW5jQmlkXSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmJpZE9wdGlvbnMgLmluY3JlbWVudC12YWx1ZScpKTsNCiAgICAgICAgICAgICAgICAgICAgYltwLnNlYXJjaC5ib3RNb2RlTWluQmlkXSA9ICgpID0+IGIuc2VhcmNoLmVuYWJsZUJvdE1vZGUgPyBidXlOb3coKSA6IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmJvdE1vZGVNaW5CdXldID0gKCkgPT4gYi5zZWFyY2guZW5hYmxlQm90TW9kZSA/IGJ1eU5vdygpIDogZmFsc2U7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKGl0ZW1zRXhpc3RzICYmICQoJy5EZXRhaWxQYW5lbCA+IC51dC1idXR0b24tZ3JvdXAnKS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgIGJbcC5yZXN1bHRzLnRyYW5zZmVyXSA9ICgpID0+IG1vdXNlQ2xpY2sodHJhbnNmZXJCdG4oKSk7DQogICAgICAgICAgICAgICAgICAgIGJbcC5yZXN1bHRzLmNsdWJdID0gKCkgPT4gbW91c2VDbGljayhjbHViQnRuKCkpOw0KICAgICAgICAgICAgICAgICAgICBiW3AucmVzdWx0cy5zZWxsXSA9ICgpID0+IG1vdXNlQ2xpY2soc2VsbEJ0bigpKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoaXRlbXNFeGlzdHMpIHsNCiAgICAgICAgICAgICAgICAgICAgYltwLmxpc3RzLnVwXSA9ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBpdGVtc0NvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZCA9ICQoJy5saXN0RlVUSXRlbS5zZWxlY3RlZCcsIGNvbnRhaW5lcikucHJldigpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gJCgiLmxpc3RGVVRJdGVtOmxhc3QtY2hpbGQiLCBjb250YWluZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbW91c2VDbGljayhzZWxlY3RlZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY3NzKCdwb3NpdGlvbicsICdyZWxhdGl2ZScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnNjcm9sbFRvcChjb250YWluZXIuc2Nyb2xsVG9wKCkgKyBzZWxlY3RlZC5wb3NpdGlvbigpLnRvcCAtIHNlbGVjdGVkLmhlaWdodCgpKTsNCiAgICAgICAgICAgICAgICAgICAgfTsNCiAgICAgICAgICAgICAgICAgICAgYltwLmxpc3RzLmRvd25dID0gKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGNvbnRhaW5lciA9IGl0ZW1zQ29udGFpbmVyOw0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkID0gJCgnLmxpc3RGVVRJdGVtLnNlbGVjdGVkJywgY29udGFpbmVyKS5uZXh0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWQubGVuZ3RoID09PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZWN0ZWQgPSAkKCIubGlzdEZVVEl0ZW06Zmlyc3QtY2hpbGQiLCBjb250YWluZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgbW91c2VDbGljayhzZWxlY3RlZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBjb250YWluZXIuY3NzKCdwb3NpdGlvbicsICdyZWxhdGl2ZScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLnNjcm9sbFRvcChjb250YWluZXIuc2Nyb2xsVG9wKCkgKyBzZWxlY3RlZC5wb3NpdGlvbigpLnRvcCk7DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmJvdE1vZGVNaW5CaWRdID0gKCkgPT4gYi5zZWFyY2guZW5hYmxlQm90TW9kZSA/IGJhY2soKSA6IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmJvdE1vZGVNaW5CdXldID0gKCkgPT4gYi5zZWFyY2guZW5hYmxlQm90TW9kZSA/IGJhY2soKSA6IGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmICgkKCcucGFnaW5nQ29udGFpbmVyJykubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICBiW3AubGlzdHMucHJldl0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5wYWdpbmdDb250YWluZXIgLnByZXY6dmlzaWJsZScpKTsNCiAgICAgICAgICAgICAgICAgICAgYltwLmxpc3RzLm5leHRdID0gKCkgPT4gbW91c2VDbGljaygkKCcucGFnaW5nQ29udGFpbmVyIC5uZXh0OnZpc2libGUnKSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gYjsNCiAgICAgICAgfTsNCg0KICAgIC8vIFVJIHVwZGF0ZSBhZnRlciBidXkgbm93DQogICAgY29uc3QgdXBkYXRlQm91Z2h0VUkgPSAoKSA9PiB7DQogICAgICAgIGlmICghZW5hYmxlZCkgcmV0dXJuOw0KDQogICAgICAgIHZhciB0eEJ0biA9IHRyYW5zZmVyQnRuKCk7DQogICAgICAgIGlmICh0eEJ0bi5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgc2V0VGltZW91dCh1cGRhdGVCb3VnaHRVSSwgNTApOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IHVwZCA9ICh0LCB0eCkgPT4gew0KICAgICAgICAgICAgaWYgKCF0KSByZXR1cm47DQogICAgICAgICAgICBsZXQgYWRkID0gYCBbICR7cC5yZXN1bHRzW3R4XX0gXWA7DQogICAgICAgICAgICBsZXQgaHRtbCA9IHQuaHRtbCgpOw0KICAgICAgICAgICAgaWYgKGh0bWwgJiYgaHRtbC5pbmRleE9mKGFkZCkgPT0gLTEpIHsNCiAgICAgICAgICAgICAgICB0Lmh0bWwodC5odG1sKCkgKyBhZGQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQoNCiAgICAgICAgdXBkKHR4QnRuLCAndHJhbnNmZXInKTsNCiAgICAgICAgdXBkKGNsdWJCdG4oKSwgJ2NsdWInKTsNCiAgICAgICAgdXBkKHNlbGxCdG4oKSwgJ3NlbGwnKTsNCiAgICB9Ow0KDQogICAgY29uc3QgYWRkQ3NzID0gKCkgPT4gew0KICAgICAgICBsZXQgYnRuID0gKHEsIGsxLCBrMiwgaW5jKSA9PiBgJHtxfSAuJHsoaW5jID8gJ2luJyA6ICdkZScpfWNyZW1lbnQtdmFsdWU6YWZ0ZXIgeyBmb250LXNpemU6MTBweDsgZGlzcGxheTpibG9jazsgbWFyZ2luLXRvcDotMzBweDsgY29udGVudDogJ1sgJHtwW2sxXVtrMl19IF0nIH1gOw0KICAgICAgICBsZXQgc3AxID0gKGksIGssIGluYykgPT4gYnRuKGAuc2VhcmNoLXByaWNlcyAucHJpY2UtZmlsdGVyOm50aC1jaGlsZCgke2l9KWAsICdzZWFyY2gnLCBrLCBpbmMpOw0KICAgICAgICBsZXQgc3AyID0gKGksIGsxLCBrMikgPT4gYCR7c3AxKGksIGsxKX0ke3NwMShpLCBrMiwgdHJ1ZSl9YDsNCiAgICAgICAgbGV0IGNzcyA9IGANCiAgICAgICAgICAgICR7c3AyKDIsICdkZWNNaW5CaWQnLCAnaW5jTWluQmlkJyl9DQogICAgICAgICAgICAke3NwMigzLCAnZGVjTWF4QmlkJywgJ2luY01heEJpZCcpfQ0KICAgICAgICAgICAgJHtzcDIoNSwgJ2RlY01pbkJ1eScsICdpbmNNaW5CdXknKX0NCiAgICAgICAgICAgICR7c3AyKDYsICdkZWNNYXhCdXknLCAnaW5jTWF4QnV5Jyl9DQogICAgICAgICAgICAke2J0bignLkRldGFpbFBhbmVsID4gLmJpZE9wdGlvbnMnLCAncmVzdWx0cycsICdkZWNCaWQnLCBmYWxzZSl9DQogICAgICAgICAgICAke2J0bignLkRldGFpbFBhbmVsID4gLmJpZE9wdGlvbnMnLCAncmVzdWx0cycsICdpbmNCaWQnLCB0cnVlKX0NCiAgICAgICAgICAgIC51dC1tYXJrZXQtc2VhcmNoLWZpbHRlcnMtdmlldyAuY2FsbC10by1hY3Rpb246YWZ0ZXIgeyBjb250ZW50OiAnWyAke3Auc2VhcmNoLnNlYXJjaH1dJ30NCiAgICAgICAgICAgIC51dC1tYXJrZXQtc2VhcmNoLWZpbHRlcnMtdmlldyAuc2VhcmNoLXByaWNlLWhlYWRlcjpmaXJzdC1jaGlsZCA+IGJ1dHRvbjphZnRlciB7IGNvbnRlbnQ6ICdbICR7cC5zZWFyY2gucmVzZXRCaWR9XSc7ICBmb250LXNpemU6IDEwcHg7IGRpc3BsYXk6IGJsb2NrICB9DQogICAgICAgICAgICAudXQtbmF2aWdhdGlvbi1idXR0b24tY29udHJvbDphZnRlciB7IGZvbnQtc2l6ZToxMHB4OyBmbG9hdDpyaWdodDsgbWFyZ2luLXJpZ2h0OjEycHg7IGNvbnRlbnQ6ICdbICR7cC5iYWNrfSBdJyB9DQogICAgICAgICAgICAucGFnaW5nQ29udGFpbmVyIC5wcmV2OmFmdGVyIHsgZm9udC1zaXplOiAxMHB4OyBkaXNwbGF5OmJsb2NrOyBjb250ZW50OiAnWyAke3AubGlzdHMucHJldn0gXScgfQ0KICAgICAgICAgICAgLnBhZ2luZ0NvbnRhaW5lciAubmV4dDphZnRlciB7IGZvbnQtc2l6ZTogMTBweDsgZGlzcGxheTpibG9jazsgY29udGVudDogJ1sgJHtwLmxpc3RzLm5leHR9IF0nIH0NCiAgICAgICAgICAgIC5iaWRCdXR0b246YWZ0ZXIgeyBjb250ZW50OiAnIFsgJHtwLnJlc3VsdHMuYmlkfSBdJyB9DQogICAgICAgICAgICAuYnV5QnV0dG9uOmJlZm9yZSB7IGZsb2F0OnJpZ2h0OyBjb250ZW50OiAnIFsgJHtwLnJlc3VsdHMuYnV5fSBdJyB9DQogICAgICAgICAgICAucGxheWVyLWRlZmluaXRpb24taWQgeyBwb3NpdGlvbjogYWJzb2x1dGU7IGJvdHRvbTogMDsgfQ0KICAgICAgICAgICAgLnNhdmVkLWZpbHRlcnMgeyBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IG1hcmdpbi1sZWZ0OiA4cHg7IG1hcmdpbi1ib3R0b206IDhweDt9DQogICAgICAgICAgICAuc2F2ZWQtZmlsdGVycyA+IGlucHV0IHtkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IHdpZHRoOiBhdXRvOyB9DQogICAgICAgICAgICAuc2F2ZWQtZmlsdGVycyA+IGJ1dHRvbiB7IGRpc3BsYXk6IGlubGluZS1ibG9jazsgbWFyZ2luLWxlZnQ6IDhweDt9DQogICAgICAgICAgICAuc2F2ZWQtZmlsdGVycyA+IGRpdiB7IGZsb2F0OiByaWdodDsgbWFyZ2luLWxlZnQ6IDhweDt9DQogICAgICAgICAgICAubWluLXByaWNlLWxhYmVsLCAubWF4LXByaWNlLWxhYmVsIHsgY29sb3I6ICM4ODkwOWI7IG1hcmdpbi1yaWdodDogMnB4OyB9DQogICAgICAgICAgICAubWluLXByaWNlLWxhYmVsOmFmdGVyLCAubWF4LXByaWNlLWxhYmVsOmFmdGVyIHsgY29udGVudDogJzonIH0NCiAgICAgICAgICAgIC5taW4tbWF4LXByaWNlcyB7IGZvbnQtc2l6ZTogMTRweDsgfQ0KICAgICAgICAgICAgLm1heC1wcmljZSB7IGZsb2F0OiByaWdodDsgfQ0KICAgICAgICAgICAgLmRvbmF0aW9uLXVpIHsgZmxvYXQ6IGxlZnQ7IG1hcmdpbi1sZWZ0OiAyMHB4OyBsaW5lLWhlaWdodDogNTBweDt9DQogICAgICAgICAgICAuZG9uYXRpb24tdWkgPiBoMywgLmRvbmF0aW9uLXVpID4gZGl2IHsgZGlzcGxheTogaW5saW5lIH0NCiAgICAgICAgICAgIC5kb25hdGlvbi11aSA+IGRpdjpiZWZvcmUgeyBjb250ZW50OiAnfCc7IG1hcmdpbi1yaWdodDogOHB4OyB9DQogICAgICAgICAgICAuZG9uYXRpb24tdWkgYSB7IGNvbG9yOiB3aGl0ZTsgfQ0KICAgICAgICAgICAgYDsNCg0KICAgICAgICBhcHBTdHlsZXMuaW5uZXJUZXh0ID0gY3NzOw0KICAgIH07DQoNCiAgICBmdW5jdGlvbiBhZGREb25hdGlvblVJKCl7DQogICAgICAgICQoIi51dC1maWZhLWhlYWRlci12aWV3IikuYXBwZW5kKGA8ZGl2IGNsYXNzPSdkb25hdGlvbi11aSc+DQogICAgICAgICAgICAgICAgPGgzIGNsYXNzPSJ0aXRsZSI+UG93ZXJlZCBieSBQYWxldG9vbHM8L2gzPg0KICAgICAgICAgICAgICAgIDxkaXY+PGEgaHJlZj0iaHR0cHM6Ly9zdHJlYW1sYWJzLmNvbS9wYWxldGFfYXIvdGlwIiB0YXJnZXQ9Il9ibGFuayI+UGF5UGFsIERvbmF0aW9uPC9hPjwvZGl2Pg0KICAgICAgICAgICAgICAgIDxkaXY+PGEgaHJlZj0iaHR0cHM6Ly9jZW5la2EubmV0L21wL2QvcGFsZXRhZWFhIiB0YXJnZXQ9Il9ibGFuayI+TWVyY2Fkb1BhZ28gRG9uYXRpb248L2E+PC9kaXY+DQogICAgICAgICAgICAgICAgPGRpdj5Gb2xsb3cgbWUgYXQmbmJzcDs8YSBocmVmPSJodHRwczovL3R3aXR0ZXIuY29tL3BhbGV0YSIgdGFyZ2V0PSJfYmxhbmsiPkBwYWxldGE8L2E+PC9kaXY+DQogICAgICAgICAgICA8L2Rpdj5gKTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBlbmFibGVEaXNhYmxlQXBwKCkgew0KICAgICAgICBpZiAoZW5hYmxlZCkgew0KICAgICAgICAgICAgZGlzYWJsZUFwcCgpOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgZW5hYmxlQXBwKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBlbmFibGVBcHAoKSB7DQogICAgICAgIGVuYWJsZWQgPSB0cnVlOw0KICAgICAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGFwcFN0eWxlcyk7DQogICAgICAgIHNlcnZpY2VzLk5vdGlmaWNhdGlvbi5xdWV1ZShbIlBhbGVzbmlwZSBFbmFibGVkIiwgVUlOb3RpZmljYXRpb25UeXBlLlBPU0lUSVZFXSkNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBkaXNhYmxlQXBwKCkgew0KICAgICAgICBlbmFibGVkID0gZmFsc2U7DQogICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoYXBwU3R5bGVzKTsNCiAgICAgICAgc2VydmljZXMuTm90aWZpY2F0aW9uLnF1ZXVlKFsiUGFsZXNuaXBlIERpc2FibGVkIiwgVUlOb3RpZmljYXRpb25UeXBlLk5FVVRSQUxdKQ0KICAgIH0NCg0KICAgIGRvY3VtZW50LmJvZHkuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGUgPT4gew0KICAgICAgICBpZiAoZS5jb2RlID09IHAuZW5hYmxlRGlzYWJsZSkgew0KICAgICAgICAgICAgZW5hYmxlRGlzYWJsZUFwcCgpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCFlbmFibGVkKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICBsZXQgYWN0aW9uID0ga2V5cygpW2UuY29kZV07DQogICAgICAgIGlmIChhY3Rpb24pIGFjdGlvbigpOw0KICAgIH0pOw0KDQogICAgYWRkQ3NzKCk7DQogICAgYWRkRG9uYXRpb25VSSgpOw0KICAgIGVuYWJsZUFwcCgpOw0KfSkoLypCVVRUT05TKi8pOw=="