window.paletools = window.paletools || {};
window.paletools['palesnipe-2.5.0'] = "KGZ1bmN0aW9uIChidXR0b25zKSB7DQogICAgY29uc3QgVkVSU0lPTiA9ICJ2Mi41LjAiOw0KDQogICAgYnV0dG9ucyA9ICQuZXh0ZW5kKHsNCiAgICAgICAgYmFjazogJ0RpZ2l0MScsDQogICAgICAgIGVuYWJsZURpc2FibGU6ICdDb21tYScsDQogICAgICAgIGxpc3RzOiB7DQogICAgICAgICAgICB1cDogJ0Fycm93VXAnLA0KICAgICAgICAgICAgZG93bjogJ0Fycm93RG93bicsDQogICAgICAgICAgICBwcmV2OiAnQXJyb3dMZWZ0JywNCiAgICAgICAgICAgIG5leHQ6ICdBcnJvd1JpZ2h0JywNCiAgICAgICAgfSwNCiAgICAgICAgc2VhcmNoOiB7DQogICAgICAgICAgICByZXNldEJpZDogJ0JhY2txdW90ZScsDQogICAgICAgICAgICBkZWNNaW5CaWQ6ICdBcnJvd0xlZnQnLA0KICAgICAgICAgICAgaW5jTWluQmlkOiAnQXJyb3dSaWdodCcsDQogICAgICAgICAgICBkZWNNYXhCaWQ6ICdFbmQnLA0KICAgICAgICAgICAgaW5jTWF4QmlkOiAnSG9tZScsDQogICAgICAgICAgICBkZWNNaW5CdXk6ICdEZWxldGUnLA0KICAgICAgICAgICAgaW5jTWluQnV5OiAnUGFnZURvd24nLA0KICAgICAgICAgICAgZGVjTWF4QnV5OiAnQXJyb3dEb3duJywNCiAgICAgICAgICAgIGluY01heEJ1eTogJ0Fycm93VXAnLA0KICAgICAgICAgICAgc2VhcmNoOiAnRGlnaXQyJywNCiAgICAgICAgICAgIGJvdE1vZGVNaW5CaWQ6ICdCcmFja2V0UmlnaHQnLA0KICAgICAgICAgICAgYm90TW9kZU1pbkJ1eTogJ0JyYWNrZXRMZWZ0JywNCiAgICAgICAgICAgIGVuYWJsZUJvdE1vZGU6IGZhbHNlDQogICAgICAgIH0sDQogICAgICAgIHJlc3VsdHM6IHsNCiAgICAgICAgICAgIGJpZDogJ0RpZ2l0NCcsDQogICAgICAgICAgICBidXk6ICdEaWdpdDMnLA0KICAgICAgICAgICAgdHJhbnNmZXI6ICdLZXlSJywNCiAgICAgICAgICAgIGNsdWI6ICdLZXlDJywNCiAgICAgICAgICAgIHByZXNzRW50ZXI6IHRydWUsDQogICAgICAgICAgICBhdXRvQnV5OiBmYWxzZSwNCiAgICAgICAgICAgIHByZXZlbnRCYWNrOiBmYWxzZSwNCiAgICAgICAgICAgIHNlbGw6ICdLZXlRJywNCiAgICAgICAgICAgIGRlY0JpZDogJ0RlbGV0ZScsDQogICAgICAgICAgICBpbmNCaWQ6ICdQYWdlRG93bicNCiAgICAgICAgfQ0KICAgIH0sIGJ1dHRvbnMgfHwge30pOw0KICAgIGxldCBwID0gYnV0dG9uczsNCiAgICBsZXQgZW5hYmxlZCA9IHRydWU7DQogICAgbGV0IGJhY2tCdXR0b25MYXN0RGF0ZSA9IG5ldyBEYXRlKCk7DQogICAgbGV0IGJhY2tCdXR0b25QcmVzc2VkT25SZXN1bHQgPSBmYWxzZTsNCiAgICBsZXQgYXBwU3R5bGVzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic3R5bGUiKTsNCg0KICAgIC8vIHJlc2V0IGNvbnNvbGUNCiAgICB2YXIgaWZyYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaWZyYW1lJyk7DQogICAgaWZyYW1lLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChpZnJhbWUpOw0KICAgIHdpbmRvdy5jb25zb2xlID0gaWZyYW1lLmNvbnRlbnRXaW5kb3cuY29uc29sZTsNCg0KICAgIHdpbmRvdy5NQVhfTkVXX0lURU1TID0gTnVtYmVyLk1BWF9WQUxVRTsNCg0KDQogICAgVVRQYWdpbmF0ZWRJdGVtTGlzdFZpZXcucHJvdG90eXBlLnNldEl0ZW1zID0gZnVuY3Rpb24gKGUsIGkpIHsNCiAgICAgICAgdmFyIG8gPSB0aGlzOw0KICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVMaXN0Um93cygpLA0KICAgICAgICAgICAgZS5mb3JFYWNoKGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICAgICAgaWYgKHNob3VsZFJlbmRlckl0ZW0oZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHQgPSBuZXcgVVRJdGVtVGFibGVDZWxsVmlldzsNCiAgICAgICAgICAgICAgICAgICAgdC5zZXREYXRhKGUsIHZvaWQgMCwgdm9pZCAwLCBpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIG8ubGlzdFJvd3MucHVzaCh0KQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pLA0KICAgICAgICAgICAgdGhpcy5saXN0Um93cw0KICAgIH0NCg0KICAgIFVUSXRlbURBTy5wcm90b3R5cGUuX29sZFNlYXJjaFRyYW5zZmVyTWFya2V0ID0gVVRJdGVtREFPLnByb3RvdHlwZS5zZWFyY2hUcmFuc2Zlck1hcmtldDsNCiAgICBVVEl0ZW1EQU8ucHJvdG90eXBlLnNlYXJjaFRyYW5zZmVyTWFya2V0ID0gZnVuY3Rpb24gKGNyaXRlcmlhLCBhcmdzKSB7DQogICAgICAgIGxldCBmaWx0ZXJzID0gZ2V0RmlsdGVycygpOw0KICAgICAgICBjcml0ZXJpYS5kZWZJZCA9IGZpbHRlcnMucmVzb3VyY2VJZCA/IFtwYXJzZUludChmaWx0ZXJzLnJlc291cmNlSWQpXSA6IFtdOw0KICAgICAgICByZXR1cm4gdGhpcy5fb2xkU2VhcmNoVHJhbnNmZXJNYXJrZXQoY3JpdGVyaWEsIGFyZ3MpOw0KICAgIH0NCg0KICAgIFVUSXRlbVRhYmxlQ2VsbFZpZXcucHJvdG90eXBlLl9vbGRSZW5kZXIgPSBVVEl0ZW1UYWJsZUNlbGxWaWV3LnByb3RvdHlwZS5yZW5kZXI7DQogICAgVVRJdGVtVGFibGVDZWxsVmlldy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgdGhpcy5fb2xkUmVuZGVyKCk7DQogICAgICAgIGlmICh0aGlzLmRhdGEuaXNQbGF5ZXIoKSkgew0KICAgICAgICAgICAgJCgiLnV0LWl0ZW0tdmlldy0tbWFpbiIsIHRoaXMuX19lbnRpdHlDb250YWluZXIpLmFwcGVuZChgPHNwYW4gY2xhc3M9InBsYXllci1kZWZpbml0aW9uLWlkIj4ke3RoaXMuZGF0YS5kZWZpbml0aW9uSWR9PC9zcGFuPmApOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2hvdWxkUmVuZGVySXRlbShpdGVtKSB7DQogICAgICAgIGxldCByYXRpbmcgPSBnZXRGaWx0ZXJzKCkucmF0aW5nOw0KDQogICAgICAgIGlmICghcmF0aW5nKSB7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIGlmIChyYXRpbmcuY2hhckF0KDApID09PSAiKyIpIHsNCiAgICAgICAgICAgICAgICByYXRpbmcgPSBwYXJzZUludChyYXRpbmcuc3Vic3RyKDEpKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5yYXRpbmcgPj0gcmF0aW5nOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSBpZiAocmF0aW5nLmNoYXJBdCgwKSA9PT0gIi0iKSB7DQogICAgICAgICAgICAgICAgcmF0aW5nID0gcGFyc2VJbnQocmF0aW5nLnN1YnN0cigxKSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ucmF0aW5nIDw9IHJhdGluZzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgIHJhdGluZyA9IHBhcnNlSW50KHJhdGluZyk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ucmF0aW5nID09IHJhdGluZzsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIFVUSXRlbURvbWFpblJlcG9zaXRvcnkucHJvdG90eXBlLmlzUGlsZUZ1bGwgPSBmdW5jdGlvbiAoZSkgew0KICAgICAgICB2YXIgdCA9IDANCiAgICAgICAgICAgICwgaSA9IHRoaXMucGlsZVNpemVzLmdldChlKTsNCiAgICAgICAgc3dpdGNoIChlKSB7DQogICAgICAgICAgICBjYXNlIEl0ZW1QaWxlLlBVUkNIQVNFRDoNCiAgICAgICAgICAgICAgICB0ID0gdGhpcy51bmFzc2lnbmVkLmxlbmd0aDsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIGNhc2UgSXRlbVBpbGUuVFJBTlNGRVI6DQogICAgICAgICAgICAgICAgdCA9IHRoaXMudHJhbnNmZXIubGVuZ3RoOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgY2FzZSBJdGVtUGlsZS5JTkJPWDoNCiAgICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgIGNhc2UgSXRlbVBpbGUuQ0xVQjoNCiAgICAgICAgICAgICAgICByZXR1cm4gITENCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gKGkgfHwgMCkgPD0gdA0KICAgIH0NCg0KICAgIGNvbnN0DQogICAgICAgIGwgPSBjb25zb2xlLmxvZywNCiAgICAgICAgbG9jID0gd2luZG93LnNlcnZpY2VzLkxvY2FsaXphdGlvbiwNCiAgICAgICAgQkFDS19CVVRUT05fVEhSRVNIT0xEID0gNTAwLA0KICAgICAgICBoZWFkZXIgPSAkKCcudXQtZmlmYS1oZWFkZXItdmlldycpLA0KICAgICAgICBnZXRGaWx0ZXJzID0gKCkgPT4gew0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICByYXRpbmc6ICQoJyNmaWx0ZXItcGxheWVyLXJhdGluZycpLnZhbCgpLA0KICAgICAgICAgICAgICAgIHJlc291cmNlSWQ6ICQoJyNmaWx0ZXItcGxheWVyLXJlc291cmNlLWlkJykudmFsKCkNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgZGlzcGF0Y2hNb3VzZUV2ZW50ID0gKCR0YXJnZXQsIGV2ZW50TmFtZSkgPT4gew0KICAgICAgICAgICAgaWYgKCR0YXJnZXQubGVuZ3RoID09IDApIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIGNvbnN0IG1vdXNlRXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnTW91c2VFdmVudHMnKTsNCiAgICAgICAgICAgIG1vdXNlRXZlbnQuaW5pdEV2ZW50KGV2ZW50TmFtZSk7DQogICAgICAgICAgICAkdGFyZ2V0WzBdLmRpc3BhdGNoRXZlbnQobW91c2VFdmVudCk7DQogICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfSwNCiAgICAgICAgbW91c2VEb3duID0gdGFyZ2V0ID0+IGRpc3BhdGNoTW91c2VFdmVudCh0YXJnZXQsICdtb3VzZWRvd24nKSwNCiAgICAgICAgbW91c2VVcCA9IHRhcmdldCA9PiBkaXNwYXRjaE1vdXNlRXZlbnQodGFyZ2V0LCAnbW91c2V1cCcpLA0KICAgICAgICBtb3VzZUNsaWNrID0gKHRhcmdldCwgZGVsYXksIGNhbGxiYWNrKSA9PiB7DQogICAgICAgICAgICBpZiAoZGVsYXkpIHsNCiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2sobW91c2VDbGljayh0YXJnZXQpKTsNCiAgICAgICAgICAgICAgICB9LCBkZWxheSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gbW91c2VEb3duKHRhcmdldCkgJiYgbW91c2VVcCh0YXJnZXQpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBidXlOb3cgPSAoY2FsbGJhY2spID0+IHsNCiAgICAgICAgICAgIGlmIChtb3VzZUNsaWNrKGJ1eUJ0bigpKSkgew0KICAgICAgICAgICAgICAgIGlmIChwLnJlc3VsdHMucHJlc3NFbnRlcikgew0KICAgICAgICAgICAgICAgICAgICB0cnlQcmVzc09rQnRuKGNhbGxiYWNrKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIHRyeVByZXNzT2tCdG4gPSAoY2FsbGJhY2spID0+IHsNCiAgICAgICAgICAgIGlmICghbW91c2VDbGljayhlbnRlckJ0bigpKSkgew0KICAgICAgICAgICAgICAgIGlmIChjYWxsYmFjaykgew0KICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGNhbGxiYWNrKGZhbHNlKSwgMCk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgc2V0VGltZW91dCh0cnlQcmVzc09rQnRuLCAxMCk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgaWYgKGNhbGxiYWNrKSB7DQogICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKHRydWUpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB1cGRhdGVCb3VnaHRVSSgpOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBiYWNrID0gKCkgPT4gew0KICAgICAgICAgICAgbCgnYmFjaycpOw0KICAgICAgICAgICAgLy8gZm9yY2UgZG91YmxlIGJhY2sgd2hlbiB0aGVyZSBpcyBhIGNhcmQgb24gdGhlIGxpc3QNCiAgICAgICAgICAgIC8vIGlmIChuZXcgRGF0ZSgpIC0gYmFja0J1dHRvbkxhc3REYXRlIDwgQkFDS19CVVRUT05fVEhSRVNIT0xEKSB7DQogICAgICAgICAgICAvLyAgICAgcmV0dXJuOw0KICAgICAgICAgICAgLy8gfQ0KICAgICAgICAgICAgLy8gYmFja0J1dHRvbkxhc3REYXRlID0gbmV3IERhdGUoKTsNCiAgICAgICAgICAgIGlmICghbW91c2VDbGljayhiYWNrQnRuKCkpKSB7DQogICAgICAgICAgICAgICAgc2V0VGltZW91dChiYWNrLCAxKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCg0KICAgICAgICBzZWFyY2ggPSAoKSA9PiB7DQogICAgICAgICAgICBtb3VzZUNsaWNrKHNlYXJjaEJ0bigpKTsNCiAgICAgICAgICAgIGlmIChwLnJlc3VsdHMuYXV0b0J1eSkgew0KICAgICAgICAgICAgICAgIGlmIChzZWFyY2hSZXN1bHRzKCkgPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICBsKCdyZXNlYXJjaGluZycpOw0KICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHNlYXJjaCwgMTApOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgbCgkKCIudXQtbm8tcmVzdWx0cy12aWV3IikubGVuZ3RoKTsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCQoIi51dC1uby1yZXN1bHRzLXZpZXciKS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsKCdubyByZXN1bHRzJyk7DQogICAgICAgICAgICAgICAgICAgICAgICBiYWNrKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICBsKCdidXlpbmcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJ1eU5vdygoYm91Z2h0KSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvdWdodCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb3VzZUNsaWNrKHRyYW5zZmVyQnRuKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIHRyYW5zZmVyQnRuID0gKCkgPT4gJChgLnV0LWJ1dHRvbi1ncm91cCA+IGJ1dHRvbjpjb250YWlucygnJHtsb2MubG9jYWxpemUoJ2luZm9wYW5lbC5sYWJlbC5zZW5kVHJhZGVQaWxlJyl9JylgKSwNCiAgICAgICAgY2x1YkJ0biA9ICgpID0+ICQoYC51dC1idXR0b24tZ3JvdXAgPiBidXR0b246Y29udGFpbnMoJyR7bG9jLmxvY2FsaXplKCdpbmZvcGFuZWwubGFiZWwuc3RvcmVJbkNsdWInKX0nKWApLA0KICAgICAgICBzZWxsQnRuID0gKCkgPT4gJChgLnV0LWJ1dHRvbi1ncm91cCA+IGJ1dHRvbjpjb250YWlucygnJHtsb2MubG9jYWxpemUoJ2luZm9wYW5lbC5sYWJlbC5kaXNjYXJkJyl9JylgKSwNCiAgICAgICAgYnV5QnRuID0gKCkgPT4gJCgnLmJ1eUJ1dHRvbicpLA0KICAgICAgICBiYWNrQnRuID0gKCkgPT4gJCgnLnV0LW5hdmlnYXRpb24tYnV0dG9uLWNvbnRyb2wnKSwNCiAgICAgICAgZW50ZXJCdG4gPSAoKSA9PiAkKCcuZWEtZGlhbG9nLXZpZXcgLnV0LWJ1dHRvbi1ncm91cCBidXR0b246ZXEoMCknKSwNCiAgICAgICAgc2VhcmNoQnRuID0gKCkgPT4gJCgnLmJ1dHRvbi1jb250YWluZXIgLmJ0bi1zdGFuZGFyZC5jYWxsLXRvLWFjdGlvbicpLA0KICAgICAgICBzZWFyY2hSZXN1bHRzID0gKCkgPT4gJCgnLlNlYXJjaFJlc3VsdHMnKS5sZW5ndGgsDQoNCg0KICAgICAgICBrZXlzID0gKCkgPT4gew0KICAgICAgICAgICAgbGV0IGIgPSB7fTsNCg0KICAgICAgICAgICAgYltwLmJhY2tdID0gKCkgPT4gYmFjaygpOw0KDQogICAgICAgICAgICBpZiAoJCgnLnV0LW1hcmtldC1zZWFyY2gtZmlsdGVycy12aWV3JykubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guZGVjTWluQmlkXSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmRlY3JlbWVudC12YWx1ZScpKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmluY01pbkJpZF0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5pbmNyZW1lbnQtdmFsdWUnKSk7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5kZWNNYXhCaWRdID0gKCkgPT4gbW91c2VDbGljaygkKCcuZGVjcmVtZW50LXZhbHVlOmVxKDEpJykpOw0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guaW5jTWF4QmlkXSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmluY3JlbWVudC12YWx1ZTplcSgxKScpKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmRlY01pbkJ1eV0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5kZWNyZW1lbnQtdmFsdWU6ZXEoMiknKSk7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5pbmNNaW5CdXldID0gKCkgPT4gbW91c2VDbGljaygkKCcuaW5jcmVtZW50LXZhbHVlOmVxKDIpJykpOw0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guZGVjTWF4QnV5XSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLmRlY3JlbWVudC12YWx1ZTplcSgzKScpKTsNCiAgICAgICAgICAgICAgICBiW3Auc2VhcmNoLmluY01heEJ1eV0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5pbmNyZW1lbnQtdmFsdWU6ZXEoMyknKSk7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5zZWFyY2hdID0gKCkgPT4gc2VhcmNoKCk7DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5yZXNldEJpZF0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5zZWFyY2gtcHJpY2UtaGVhZGVyID4gYnV0dG9uOmZpcnN0JykpOw0KICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guYm90TW9kZU1pbkJpZF0gPSAoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGlmIChiLnNlYXJjaC5lbmFibGVCb3RNb2RlICYmIGJbcC5zZWFyY2guaW5jTWluQmlkXSgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzZWFyY2goKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgYltwLnNlYXJjaC5ib3RNb2RlTWluQnV5XSA9ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGIuc2VhcmNoLmVuYWJsZUJvdE1vZGUgJiYgYltwLnNlYXJjaC5pbmNNaW5CdXldKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHNlYXJjaCgpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgbGV0IGl0ZW1zID0gJCgiLmxpc3RGVVRJdGVtIik7DQogICAgICAgICAgICAgICAgbGV0IGl0ZW1zRXhpc3RzID0gaXRlbXMubGVuZ3RoID4gMDsNCiAgICAgICAgICAgICAgICBsZXQgaXRlbXNDb250YWluZXIgPSBpdGVtcy5wYXJlbnRzKCcucGFnaW5hdGVkLCAudXQtd2F0Y2gtbGlzdC12aWV3LCAudXQtdHJhbnNmZXItbGlzdC12aWV3Jyk7DQogICAgICAgICAgICAgICAgaWYgKGl0ZW1zQ29udGFpbmVyLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIGl0ZW1zQ29udGFpbmVyID0gaXRlbXMucGFyZW50KCk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKGl0ZW1zRXhpc3RzICYmICQoJy5EZXRhaWxQYW5lbCA+IC5iaWRPcHRpb25zJykubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICBiW3AucmVzdWx0cy5iaWRdID0gKCkgPT4gbW91c2VDbGljaygkKCcuYmlkQnV0dG9uJykpOw0KICAgICAgICAgICAgICAgICAgICBiW3AucmVzdWx0cy5idXldID0gKCkgPT4gYnV5Tm93KCk7DQogICAgICAgICAgICAgICAgICAgIGJbcC5yZXN1bHRzLmRlY0JpZF0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5iaWRPcHRpb25zIC5kZWNyZW1lbnQtdmFsdWUnKSk7DQogICAgICAgICAgICAgICAgICAgIGJbcC5yZXN1bHRzLmluY0JpZF0gPSAoKSA9PiBtb3VzZUNsaWNrKCQoJy5iaWRPcHRpb25zIC5pbmNyZW1lbnQtdmFsdWUnKSk7DQogICAgICAgICAgICAgICAgICAgIGJbcC5zZWFyY2guYm90TW9kZU1pbkJpZF0gPSAoKSA9PiBiLnNlYXJjaC5lbmFibGVCb3RNb2RlID8gYnV5Tm93KCkgOiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgYltwLnNlYXJjaC5ib3RNb2RlTWluQnV5XSA9ICgpID0+IGIuc2VhcmNoLmVuYWJsZUJvdE1vZGUgPyBidXlOb3coKSA6IGZhbHNlOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmIChpdGVtc0V4aXN0cyAmJiAkKCcuRGV0YWlsUGFuZWwgPiAudXQtYnV0dG9uLWdyb3VwJykubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICBiW3AucmVzdWx0cy50cmFuc2Zlcl0gPSAoKSA9PiBtb3VzZUNsaWNrKHRyYW5zZmVyQnRuKCkpOw0KICAgICAgICAgICAgICAgICAgICBiW3AucmVzdWx0cy5jbHViXSA9ICgpID0+IG1vdXNlQ2xpY2soY2x1YkJ0bigpKTsNCiAgICAgICAgICAgICAgICAgICAgYltwLnJlc3VsdHMuc2VsbF0gPSAoKSA9PiBtb3VzZUNsaWNrKHNlbGxCdG4oKSk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgaWYgKGl0ZW1zRXhpc3RzKSB7DQogICAgICAgICAgICAgICAgICAgIGJbcC5saXN0cy51cF0gPSAoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgY29udGFpbmVyID0gaXRlbXNDb250YWluZXI7DQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWQgPSAkKCcubGlzdEZVVEl0ZW0uc2VsZWN0ZWQnLCBjb250YWluZXIpLnByZXYoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZC5sZW5ndGggPT09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxlY3RlZCA9ICQoIi5saXN0RlVUSXRlbTpsYXN0LWNoaWxkIiwgY29udGFpbmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIG1vdXNlQ2xpY2soc2VsZWN0ZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmNzcygncG9zaXRpb24nLCAncmVsYXRpdmUnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5zY3JvbGxUb3AoY29udGFpbmVyLnNjcm9sbFRvcCgpICsgc2VsZWN0ZWQucG9zaXRpb24oKS50b3AgLSBzZWxlY3RlZC5oZWlnaHQoKSk7DQogICAgICAgICAgICAgICAgICAgIH07DQogICAgICAgICAgICAgICAgICAgIGJbcC5saXN0cy5kb3duXSA9ICgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjb250YWluZXIgPSBpdGVtc0NvbnRhaW5lcjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZCA9ICQoJy5saXN0RlVUSXRlbS5zZWxlY3RlZCcsIGNvbnRhaW5lcikubmV4dCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkID0gJCgiLmxpc3RGVVRJdGVtOmZpcnN0LWNoaWxkIiwgY29udGFpbmVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIG1vdXNlQ2xpY2soc2VsZWN0ZWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyLmNzcygncG9zaXRpb24nLCAncmVsYXRpdmUnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lci5zY3JvbGxUb3AoY29udGFpbmVyLnNjcm9sbFRvcCgpICsgc2VsZWN0ZWQucG9zaXRpb24oKS50b3ApOw0KICAgICAgICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgYltwLnNlYXJjaC5ib3RNb2RlTWluQmlkXSA9ICgpID0+IGIuc2VhcmNoLmVuYWJsZUJvdE1vZGUgPyBiYWNrKCkgOiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgYltwLnNlYXJjaC5ib3RNb2RlTWluQnV5XSA9ICgpID0+IGIuc2VhcmNoLmVuYWJsZUJvdE1vZGUgPyBiYWNrKCkgOiBmYWxzZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBpZiAoJCgnLnBhZ2luZ0NvbnRhaW5lcicpLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgYltwLmxpc3RzLnByZXZdID0gKCkgPT4gbW91c2VDbGljaygkKCcucGFnaW5nQ29udGFpbmVyIC5wcmV2OnZpc2libGUnKSk7DQogICAgICAgICAgICAgICAgICAgIGJbcC5saXN0cy5uZXh0XSA9ICgpID0+IG1vdXNlQ2xpY2soJCgnLnBhZ2luZ0NvbnRhaW5lciAubmV4dDp2aXNpYmxlJykpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGI7DQogICAgICAgIH07DQoNCiAgICAvLyBVSSB1cGRhdGUgYWZ0ZXIgYnV5IG5vdw0KICAgIGNvbnN0IHVwZGF0ZUJvdWdodFVJID0gKCkgPT4gew0KICAgICAgICBpZiAoIWVuYWJsZWQpIHJldHVybjsNCg0KICAgICAgICB2YXIgdHhCdG4gPSB0cmFuc2ZlckJ0bigpOw0KICAgICAgICBpZiAodHhCdG4ubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgIHNldFRpbWVvdXQodXBkYXRlQm91Z2h0VUksIDUwKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KDQogICAgICAgIGxldCB1cGQgPSAodCwgdHgpID0+IHsNCiAgICAgICAgICAgIGlmICghdCkgcmV0dXJuOw0KICAgICAgICAgICAgbGV0IGFkZCA9IGAgWyAke3AucmVzdWx0c1t0eF19IF1gOw0KICAgICAgICAgICAgbGV0IGh0bWwgPSB0Lmh0bWwoKTsNCiAgICAgICAgICAgIGlmIChodG1sICYmIGh0bWwuaW5kZXhPZihhZGQpID09IC0xKSB7DQogICAgICAgICAgICAgICAgdC5odG1sKHQuaHRtbCgpICsgYWRkKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHVwZCh0eEJ0biwgJ3RyYW5zZmVyJyk7DQogICAgICAgIHVwZChjbHViQnRuKCksICdjbHViJyk7DQogICAgICAgIHVwZChzZWxsQnRuKCksICdzZWxsJyk7DQogICAgfTsNCg0KICAgIGNvbnN0IGFkZENzcyA9ICgpID0+IHsNCiAgICAgICAgbGV0IGJ0biA9IChxLCBrMSwgazIsIGluYykgPT4gYCR7cX0gLiR7KGluYyA/ICdpbicgOiAnZGUnKX1jcmVtZW50LXZhbHVlOmFmdGVyIHsgZm9udC1zaXplOjEwcHg7IGRpc3BsYXk6YmxvY2s7IG1hcmdpbi10b3A6LTMwcHg7IGNvbnRlbnQ6ICdbICR7cFtrMV1bazJdfSBdJyB9YDsNCiAgICAgICAgbGV0IHNwMSA9IChpLCBrLCBpbmMpID0+IGJ0bihgLnNlYXJjaC1wcmljZXMgLnByaWNlLWZpbHRlcjpudGgtY2hpbGQoJHtpfSlgLCAnc2VhcmNoJywgaywgaW5jKTsNCiAgICAgICAgbGV0IHNwMiA9IChpLCBrMSwgazIpID0+IGAke3NwMShpLCBrMSl9JHtzcDEoaSwgazIsIHRydWUpfWA7DQogICAgICAgIGxldCBjc3MgPSBgDQogICAgICAgICAgICAke3NwMigyLCAnZGVjTWluQmlkJywgJ2luY01pbkJpZCcpfQ0KICAgICAgICAgICAgJHtzcDIoMywgJ2RlY01heEJpZCcsICdpbmNNYXhCaWQnKX0NCiAgICAgICAgICAgICR7c3AyKDUsICdkZWNNaW5CdXknLCAnaW5jTWluQnV5Jyl9DQogICAgICAgICAgICAke3NwMig2LCAnZGVjTWF4QnV5JywgJ2luY01heEJ1eScpfQ0KICAgICAgICAgICAgJHtidG4oJy5EZXRhaWxQYW5lbCA+IC5iaWRPcHRpb25zJywgJ3Jlc3VsdHMnLCAnZGVjQmlkJywgZmFsc2UpfQ0KICAgICAgICAgICAgJHtidG4oJy5EZXRhaWxQYW5lbCA+IC5iaWRPcHRpb25zJywgJ3Jlc3VsdHMnLCAnaW5jQmlkJywgdHJ1ZSl9DQogICAgICAgICAgICAudXQtbWFya2V0LXNlYXJjaC1maWx0ZXJzLXZpZXcgLmNhbGwtdG8tYWN0aW9uOmFmdGVyIHsgY29udGVudDogJ1sgJHtwLnNlYXJjaC5zZWFyY2h9XSd9DQogICAgICAgICAgICAudXQtbWFya2V0LXNlYXJjaC1maWx0ZXJzLXZpZXcgLnNlYXJjaC1wcmljZS1oZWFkZXI6Zmlyc3QtY2hpbGQgPiBidXR0b246YWZ0ZXIgeyBjb250ZW50OiAnWyAke3Auc2VhcmNoLnJlc2V0QmlkfV0nOyAgZm9udC1zaXplOiAxMHB4OyBkaXNwbGF5OiBibG9jayAgfQ0KICAgICAgICAgICAgLnV0LW5hdmlnYXRpb24tYnV0dG9uLWNvbnRyb2w6YWZ0ZXIgeyBmb250LXNpemU6MTBweDsgZmxvYXQ6cmlnaHQ7IG1hcmdpbi1yaWdodDoxMnB4OyBjb250ZW50OiAnWyAke3AuYmFja30gXScgfQ0KICAgICAgICAgICAgLnBhZ2luZ0NvbnRhaW5lciAucHJldjphZnRlciB7IGZvbnQtc2l6ZTogMTBweDsgZGlzcGxheTpibG9jazsgY29udGVudDogJ1sgJHtwLmxpc3RzLnByZXZ9IF0nIH0NCiAgICAgICAgICAgIC5wYWdpbmdDb250YWluZXIgLm5leHQ6YWZ0ZXIgeyBmb250LXNpemU6IDEwcHg7IGRpc3BsYXk6YmxvY2s7IGNvbnRlbnQ6ICdbICR7cC5saXN0cy5uZXh0fSBdJyB9DQogICAgICAgICAgICAuYmlkQnV0dG9uOmFmdGVyIHsgY29udGVudDogJyBbICR7cC5yZXN1bHRzLmJpZH0gXScgfQ0KICAgICAgICAgICAgLmJ1eUJ1dHRvbjpiZWZvcmUgeyBmbG9hdDpyaWdodDsgY29udGVudDogJyBbICR7cC5yZXN1bHRzLmJ1eX0gXScgfQ0KICAgICAgICAgICAgYDsNCg0KICAgICAgICBhcHBTdHlsZXMuaW5uZXJUZXh0ID0gY3NzOw0KICAgIH07DQoNCiAgICBjb25zdCBhZGRGaWx0ZXJzID0gKCkgPT4gew0KICAgICAgICBoZWFkZXIuYXBwZW5kKGB8IEZpbHRlcjogUmF0aW5nOiA8aW5wdXQgdHlwZT0idGV4dCIgaWQ9ImZpbHRlci1wbGF5ZXItcmF0aW5nIiBzdHlsZT0id2lkdGg6IDYwcHgiIC8+IHwgSWQ6IDxpbnB1dCB0eXBlPSJ0ZXh0IiBpZD0iZmlsdGVyLXBsYXllci1yZXNvdXJjZS1pZCIgc3R5bGU9IndpZHRoOiAyMDBweCIgLz5gKTsNCiAgICB9Ow0KDQogICAgZnVuY3Rpb24gZW5hYmxlRGlzYWJsZUFwcCgpIHsNCiAgICAgICAgaWYgKGVuYWJsZWQpIHsNCiAgICAgICAgICAgIGRpc2FibGVBcHAoKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIGVuYWJsZUFwcCgpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZW5hYmxlQXBwKCkgew0KICAgICAgICBlbmFibGVkID0gdHJ1ZTsNCiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhcHBTdHlsZXMpOw0KICAgICAgICBzZXJ2aWNlcy5Ob3RpZmljYXRpb24ucXVldWUoWyJQYWxlc25pcGUgRW5hYmxlZCIsIFVJTm90aWZpY2F0aW9uVHlwZS5QT1NJVElWRV0pDQogICAgfQ0KDQogICAgZnVuY3Rpb24gZGlzYWJsZUFwcCgpIHsNCiAgICAgICAgZW5hYmxlZCA9IGZhbHNlOw0KICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKGFwcFN0eWxlcyk7DQogICAgICAgIHNlcnZpY2VzLk5vdGlmaWNhdGlvbi5xdWV1ZShbIlBhbGVzbmlwZSBEaXNhYmxlZCIsIFVJTm90aWZpY2F0aW9uVHlwZS5ORVVUUkFMXSkNCiAgICB9DQoNCiAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCBlID0+IHsNCiAgICAgICAgaWYgKGUuY29kZSA9PSBwLmVuYWJsZURpc2FibGUpIHsNCiAgICAgICAgICAgIGVuYWJsZURpc2FibGVBcHAoKTsNCiAgICAgICAgfQ0KDQogICAgICAgIGlmICghZW5hYmxlZCkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQoNCiAgICAgICAgbGV0IGFjdGlvbiA9IGtleXMoKVtlLmNvZGVdOw0KICAgICAgICBpZiAoYWN0aW9uKSBhY3Rpb24oKTsNCiAgICB9KTsNCg0KICAgIGFkZENzcygpOw0KICAgIGFkZEZpbHRlcnMoKTsNCiAgICBlbmFibGVBcHAoKTsNCn0pKC8qQlVUVE9OUyovKTs="